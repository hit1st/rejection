{"version":3,"file":"index.js","sources":["../src/tasks/util/filterUpdateResults.js","../src/reporters/util/Projector.js","../src/reporters/util/Terminal.js","../src/reporters/util/Message.js","../src/reporters/util/Spinner.js","../src/reporters/util/Indicator.js","../src/constants/config.js","../src/reporters/util/configList.js","../src/reporters/util/customConfigToLines.js","../src/reporters/util/pluralize.js","../src/errors.js","../src/reporters/util/handleError.js","../src/reporters/util/msToString.js","../src/reporters/dense.js","../src/reporters/none.js","../src/reporters/index.js","../src/bin/argv.js","../src/tasks/util/Sequence.js","../src/tasks/util/createUpdateTask.js","../src/constants/filterReasons.js","../src/tasks/util/filterUpdateTask.js","../src/tasks/init.js","../src/tasks/util/createUpdateResult.js","../src/tasks/util/updateTo.js","../src/tasks/util/rollbackTo.js","../src/tasks/sequentialUpdate.js","../src/tasks/util/splitUpdateTasks.js","../src/tasks/batchUpdate.js","../src/tasks/finish.js","../src/tasks/util/updateVersionRange.js","../src/tasks/util/createUpdatedPackageJson.js","../src/tasks/updatePackageJson.js","../src/run.js","../src/util/fs.js","../src/exec/exec.js","../src/exec/cmds.js","../src/exec/parse.js","../src/Updtr.js","../src/index.js","../src/bin/index.js"],"sourcesContent":["export function filterSuccessfulUpdates(results) {\n    return results.filter(result => result.success === true);\n}\n\nexport function filterFailedUpdates(results) {\n    return results.filter(result => result.success === false);\n}\n","function lineToString(line) {\n    if (Array.isArray(line) === true) {\n        return line.join(\"\");\n    }\n\n    return String(line);\n}\n\nexport default class Projector {\n    constructor(terminal, frameRate = 10) {\n        this.terminal = terminal;\n        this.delay = Math.floor(1000 / frameRate);\n        this.timeoutId = null;\n    }\n    display(frame) {\n        if (this.timeoutId !== null) {\n            this.stop();\n        }\n        this.terminal.append(frame.map(lineToString));\n        this.timeoutId = setTimeout(() => {\n            this.display(frame);\n        }, this.delay);\n    }\n    stop() {\n        if (this.timeoutId === null) {\n            return;\n        }\n        this.terminal.rewind();\n        clearTimeout(this.timeoutId);\n        this.timeoutId = null;\n    }\n}\n","import ansiEscapes from \"ansi-escapes\";\nimport cliCursor from \"cli-cursor\";\nimport stringWidth from \"string-width\";\n\nfunction calcNumOfRows(lines, columns) {\n    return lines\n        .map(lineContent => Math.ceil(stringWidth(lineContent) / columns))\n        .reduce((allRows, rows) => allRows + rows, 0);\n}\n\n// Solves some issues where stdout output is truncated\n// See https://github.com/nodejs/node/issues/6456\nfunction setBlocking(stream) {\n    if (stream._handle && typeof stream._handle.setBlocking === \"function\") {\n        stream._handle.setBlocking(true);\n    }\n}\n\nexport default class Terminal {\n    constructor(stream) {\n        if (stream.isTTY !== true) {\n            throw new Error(\"Given stream is not a TTY stream\");\n        }\n        setBlocking(stream);\n        cliCursor.hide(stream);\n        this.stream = stream;\n        this.lines = [];\n        this.hasBeenResized = false;\n        this.stream.on(\"resize\", () => {\n            this.hasBeenResized = true;\n        });\n    }\n    append(lines) {\n        if (lines.length === 0) {\n            return;\n        }\n        this.lines.push(lines);\n\n        const content = this.hasBeenResized === true ?\n            ansiEscapes.clearScreen +\n                  this.lines.map(lines => lines.join(\"\\n\")).join(\"\\n\") :\n            ansiEscapes.eraseDown + lines.join(\"\\n\");\n\n        this.stream.write(content + \"\\n\");\n        this.hasBeenResized = false;\n    }\n    rewind() {\n        const removedLines = this.lines.pop();\n        const rows = calcNumOfRows(removedLines, this.stream.columns);\n\n        this.stream.write(ansiEscapes.cursorUp(rows));\n    }\n}\n","export default class Message {\n    constructor(template, variables) {\n        this.template = template;\n        this.variables = variables;\n    }\n    valueOf() {\n        const split = this.template.split(/%s/g);\n\n        return split.reduce(\n            (str, part, i) => str + part + (this.variables[i] || \"\"),\n            \"\"\n        );\n    }\n    toString() {\n        return this.valueOf();\n    }\n}\n","import cliSpinners from \"cli-spinners\";\n\nconst isWin = process.platform === \"win32\";\nconst winFallback = \"simpleDotsScrolling\";\n\nexport default class Spinner {\n    constructor(spinnerName) {\n        const spinner = cliSpinners[isWin === true ? winFallback : spinnerName];\n\n        this.frames = spinner.frames;\n        this.interval = spinner.interval;\n        this.length = Math.max(...this.frames.map(frame => frame.length));\n    }\n    valueOf() {\n        const currentInterval = Math.floor(Date.now() / this.interval);\n        const currentFrame = currentInterval % this.frames.length;\n\n        return this.frames[currentFrame];\n    }\n    toString() {\n        return this.valueOf();\n    }\n}\n","import unicons from \"unicons\";\nimport chalk from \"chalk\";\n\nexport const INDICATOR_NEUTRAL = 0;\nexport const INDICATOR_FAIL = 1;\nexport const INDICATOR_PENDING = 2;\nexport const INDICATOR_OK = 3;\n\nconst COLORS = [chalk.grey, chalk.red, chalk.yellow, chalk.green];\n\nexport default class Indicator {\n    constructor(initialState) {\n        this.state = initialState;\n    }\n    valueOf() {\n        return COLORS[this.state](unicons.cli(\"circle\"));\n    }\n    toString() {\n        return this.valueOf();\n    }\n}\n","// The first value in arrays is the default value\n\nexport const USE_NPM = \"npm\";\nexport const USE_YARN = \"yarn\";\nexport const USE_OPTIONS = [USE_NPM, USE_YARN];\nexport const UPDATE_TO_LATEST = \"latest\";\nexport const UPDATE_TO_NON_BREAKING = \"non-breaking\";\nexport const UPDATE_TO_WANTED = \"wanted\";\nexport const UPDATE_TO_OPTIONS = [\n    UPDATE_TO_LATEST,\n    UPDATE_TO_NON_BREAKING,\n    UPDATE_TO_WANTED,\n];\nexport const SAVE_SMART = \"smart\";\nexport const SAVE_CARET = \"caret\";\nexport const SAVE_EXACT = \"exact\";\nexport const SAVE_OPTIONS = [SAVE_SMART, SAVE_CARET, SAVE_EXACT];\n","import {\n    USE_OPTIONS,\n    UPDATE_TO_OPTIONS,\n    SAVE_OPTIONS,\n} from \"../../constants/config\";\n\nconst configNames = {\n    use: \"use\",\n    exclude: \"exclude\",\n    test: \"test command\",\n    registry: \"registry\",\n    updateTo: \"update to\",\n    save: \"save\",\n};\nconst configValues = {\n    exclude: list => list.join(\", \"),\n};\nconst configFilter = {\n    cwd: () => false,\n    use: option => option !== USE_OPTIONS[0],\n    exclude: list => list.length > 0,\n    test: cmd => cmd !== undefined,\n    registry: reg => reg !== undefined,\n    updateTo: option => option !== UPDATE_TO_OPTIONS[0],\n    save: option => option !== SAVE_OPTIONS[0],\n};\n\nexport default function configList(config) {\n    return Object.keys(config)\n        .filter(key => {\n            const filter = configFilter[key];\n            const name = configNames[key];\n\n            return (\n                name !== undefined &&\n                (filter === undefined || filter(config[key]) === true)\n            );\n        })\n        .map(key => {\n            const toString = configValues[key] || String;\n\n            return `${configNames[key]}: ${toString(config[key])}`;\n        });\n}\n","import unicons from \"unicons\";\nimport configList from \"./configList\";\n\nexport default function customConfigToLines(config) {\n    const list = configList(config);\n    const lines = [];\n\n    if (list.length > 0) {\n        lines.push(\n            \"Running updtr with custom configuration:\",\n            \"\",\n            ...list.map(item => unicons.cli(\"circle\") + \" \" + item),\n            \"\"\n        );\n    }\n\n    return lines;\n}\n","export default function pluralize(num) {\n    return num === 1 ? \"\" : \"s\";\n}\n","// Errors are not extendable in node v4.\n// Remove this if node v4 is not supported anymore.\nimport Error from \"es6-error\";\n\nexport class PackageJsonNoAccessError extends Error {\n    constructor(dir) {\n        super(`Cannot access package.json in ${dir}`);\n    }\n}\n\nexport class RequiredOptionMissingError extends Error {\n    constructor(optionName, optionValue) {\n        super(\n            `Required option ${optionName} is missing. Instead received ${optionValue}`\n        );\n    }\n}\n\nexport class OptionValueNotSupportedError extends Error {\n    constructor(optionName, unsupportedValue) {\n        super(`Unsupported value ${unsupportedValue} for option ${optionName}`);\n    }\n}\n\nexport class YarnWithCustomRegistryError extends Error {\n    constructor() {\n        super(\n            \"yarn does not support custom registries yet. Please use a .npmrc file to achieve this\"\n        );\n    }\n}\n","import chalk from \"chalk\";\nimport {PackageJsonNoAccessError} from \"../../errors\";\n\nconst ERROR = chalk.bgRed.bold(\" ERROR \");\n\nexport default function handleError(err) {\n    const lines = [\"\"];\n\n    switch (err.constructor) {\n        case PackageJsonNoAccessError:\n            lines.push(\n                ERROR + \" Cannot find package.json in current directory.\"\n            );\n            break;\n        default: {\n            // The stack does only contain \\n, also on windows\n            const stack = err.stack.split(\"\\n\");\n\n            stack.shift();\n            lines.push(ERROR + \" \" + err.message);\n            lines.push(...stack.map(line => chalk.grey(line)));\n        }\n    }\n    lines.push(\"\");\n\n    console.error(lines.join(\"\\n\"));\n    process.exit(1); // eslint-disable-line no-process-exit\n}\n","function msToString(milliseconds) {\n    return Math.floor(milliseconds / 1000).toFixed(1) + \"s\";\n}\n\nexport default msToString;\n","import chalk from \"chalk\";\nimport unicons from \"unicons\";\nimport {\n    filterSuccessfulUpdates,\n    filterFailedUpdates,\n} from \"../tasks/util/filterUpdateResults\";\nimport Projector from \"./util/Projector\";\nimport Terminal from \"./util/Terminal\";\nimport Message from \"./util/Message\";\nimport Spinner from \"./util/Spinner\";\nimport Indicator, {\n    INDICATOR_NEUTRAL,\n    INDICATOR_PENDING,\n    INDICATOR_OK,\n    INDICATOR_FAIL,\n} from \"./util/Indicator\";\nimport customConfigToLines from \"./util/customConfigToLines\";\nimport pluralize from \"./util/pluralize\";\nimport handleError from \"./util/handleError\";\nimport msToString from \"./util/msToString\";\n\nconst spinner = new Spinner(\"dots\");\n\nfunction updatingLine(updateTask) {\n    return [\n        new Indicator(INDICATOR_PENDING),\n        chalk.bold(updateTask.name),\n        chalk.grey(\"updating\"),\n        updateTask.rollbackTo,\n        chalk.grey(unicons.arrowRight),\n        updateTask.updateTo + chalk.grey(\"...\"),\n    ].join(\" \");\n}\n\nfunction testingLine(updateTask) {\n    return [\n        new Indicator(INDICATOR_PENDING),\n        chalk.bold(updateTask.name),\n        chalk.grey(\"testing...\"),\n    ].join(\" \");\n}\n\nfunction rollbackLine(updateTask) {\n    return [\n        new Indicator(INDICATOR_FAIL),\n        chalk.bold.red(updateTask.name),\n        chalk.grey(\"rolling back\"),\n        updateTask.updateTo,\n        chalk.grey(unicons.arrowRight),\n        updateTask.rollbackTo + chalk.grey(\"...\"),\n    ].join(\" \");\n}\n\nfunction successLine(updateTask) {\n    return [\n        new Indicator(INDICATOR_OK),\n        chalk.bold(updateTask.name),\n        updateTask.updateTo,\n        chalk.grey(\"success\"),\n    ].join(\" \");\n}\n\nfunction failLine(updateTask) {\n    return [\n        new Indicator(INDICATOR_FAIL),\n        chalk.bold.red(updateTask.name),\n        updateTask.updateTo,\n        chalk.grey(\"failed\"),\n    ].join(\" \");\n}\n\nfunction excludedLine(excluded) {\n    return [\n        new Indicator(INDICATOR_NEUTRAL),\n        chalk.bold(excluded.name),\n        chalk.grey(excluded.reason),\n    ].join(\" \");\n}\n\nfunction cmdToLines(description, cmd) {\n    const lines = Array.isArray(description) === true ?\n        description :\n        [description];\n\n    return lines.concat([chalk.grey(`> ${cmd} `), spinner]);\n}\n\nfunction dense(updtr, reporterConfig) {\n    const terminal = new Terminal(reporterConfig.stream);\n    const projector = new Projector(terminal);\n    const startTime = Date.now();\n    let excludedModules;\n\n    updtr.on(\"start\", ({config}) => {\n        terminal.append(customConfigToLines(config));\n    });\n    updtr.on(\"init/install-missing\", ({cmd}) => {\n        projector.display(\n            cmdToLines(\n                \"Installing missing dependencies\" + chalk.grey(\"...\"),\n                cmd\n            )\n        );\n    });\n    updtr.on(\"init/collect\", ({cmd}) => {\n        projector.display(\n            cmdToLines(\"Looking for outdated modules\" + chalk.grey(\"...\"), cmd)\n        );\n    });\n    updtr.on(\"init/end\", ({updateTasks, excluded}) => {\n        excludedModules = excluded;\n        projector.stop();\n        if (updateTasks.length === 0 && excluded.length === 0) {\n            terminal.append([\"Everything \" + chalk.bold(\"up-to-date\")]);\n        } else if (updateTasks.length === 0) {\n            terminal.append([\n                chalk.bold(\"No updates available\") +\n                    \" for the given modules and version range\",\n            ]);\n        } else {\n            terminal.append([\n                new Message(\"Found \" + chalk.bold(\"%s update%s\") + \".\", [\n                    updateTasks.length,\n                    pluralize(updateTasks.length),\n                ]),\n                \"\",\n            ]);\n        }\n    });\n    updtr.on(\"batch-update/updating\", event => {\n        projector.display(\n            cmdToLines(event.updateTasks.map(updatingLine), event.cmd)\n        );\n    });\n    updtr.on(\"batch-update/testing\", event => {\n        projector.display(\n            cmdToLines(event.updateTasks.map(testingLine), event.cmd)\n        );\n    });\n    updtr.on(\"batch-update/rollback\", event => {\n        projector.display(\n            cmdToLines(event.updateTasks.map(rollbackLine), event.cmd)\n        );\n    });\n    updtr.on(\"batch-update/result\", event => {\n        projector.stop();\n        if (event.success === true) {\n            terminal.append(\n                event.updateTasks.map(event.success ? successLine : failLine)\n            );\n        }\n        // Not showing the test stdout here when there was an error because\n        // we will proceed with the sequential update.\n    });\n    updtr.on(\"sequential-update/updating\", event => {\n        projector.display(cmdToLines(updatingLine(event), event.cmd));\n    });\n    updtr.on(\"sequential-update/testing\", event => {\n        projector.display(cmdToLines(testingLine(event), event.cmd));\n    });\n    updtr.on(\"sequential-update/rollback\", event => {\n        projector.display(cmdToLines(rollbackLine(event), event.cmd));\n    });\n    updtr.on(\"sequential-update/result\", event => {\n        projector.stop();\n        terminal.append([(event.success ? successLine : failLine)(event)]);\n        if (reporterConfig.testStdout === true && event.success === false) {\n            terminal.append([event.stdout]);\n        }\n    });\n    updtr.on(\"end\", ({results}) => {\n        const duration = msToString(Date.now() - startTime);\n        const successful = filterSuccessfulUpdates(results);\n        const failed = filterFailedUpdates(results);\n\n        terminal.append([\"\"]);\n\n        if (successful.length > 0) {\n            terminal.append([\n                new Message(chalk.bold(\"%s successful\") + \" update%s.\", [\n                    successful.length,\n                    pluralize(successful.length),\n                ]),\n            ]);\n        }\n        if (failed.length > 0) {\n            terminal.append([\n                new Message(chalk.bold(\"%s failed\") + \" update%s.\", [\n                    failed.length,\n                    pluralize(failed.length),\n                ]),\n            ]);\n        }\n        if (excludedModules.length > 0) {\n            const list = excludedModules.map(excludedLine);\n\n            if (successful.length > 0 || failed.length > 0) {\n                terminal.append([\"\"]);\n            }\n            terminal.append(\n                [\n                    new Message(chalk.bold(\"%s skipped\") + \" module%s:\", [\n                        excludedModules.length,\n                        pluralize(excludedModules.length),\n                    ]),\n                    \"\",\n                ].concat(list)\n            );\n        }\n\n        terminal.append([\"\", new Message(\"Finished after %s.\", [duration])]);\n    });\n    updtr.on(\"error\", err => void handleError(err));\n}\n\nexport default dense;\n","export default Function.prototype;\n","import dense from \"./dense\";\nimport none from \"./none\";\n\n// The first property here is the default reporter\nconst reporters = {dense, none};\n\nexport default reporters;\n","import {EOL} from \"os\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport yargs from \"yargs\";\nimport chalk from \"chalk\";\nimport reporters from \"../reporters\";\nimport {\n    USE_OPTIONS,\n    USE_NPM,\n    USE_YARN,\n    UPDATE_TO_OPTIONS,\n    SAVE_OPTIONS,\n} from \"../constants/config\";\n\nconst reporterNames = Object.keys(reporters);\nconst pathToYarnLock = path.join(process.cwd(), \"yarn.lock\");\nconst useDefault = fs.existsSync(pathToYarnLock) === true ? USE_YARN : USE_NPM;\n\nexport default yargs\n    .usage(\n        [\n            \"\",\n            chalk.bold.cyan(\"Update outdated npm modules with zero painâ„¢\"),\n            `${chalk.bold(\"Usage:\")} $0 ${chalk.dim(\"[options]\")}`,\n        ].join(EOL)\n    )\n    .option(\"use\", {\n        describe: \"Specify the package manager to use\",\n        choices: USE_OPTIONS,\n        default: useDefault,\n        alias: \"u\",\n    })\n    .option(\"exclude\", {\n        describe: \"Space separated list of module names that should not be updated\",\n        array: true,\n        alias: \"ex\",\n    })\n    .option(\"update-to\", {\n        describe: \"Specify which updates you want to install\",\n        choices: UPDATE_TO_OPTIONS,\n        default: UPDATE_TO_OPTIONS[0],\n        alias: \"to\",\n    })\n    .option(\"save\", {\n        describe: \"Specify how updated versions should be saved to the package.json\",\n        choices: SAVE_OPTIONS,\n        default: SAVE_OPTIONS[0],\n        alias: \"s\",\n    })\n    .option(\"reporter\", {\n        describe: \"Choose a reporter for the console output\",\n        choices: reporterNames,\n        default: reporterNames[0],\n        alias: \"r\",\n    })\n    .option(\"test\", {\n        describe: \"Specify a custom test command. Surround with quotes.\",\n        alias: \"t\",\n    })\n    .option(\"test-stdout\", {\n        describe: \"Show test stdout if the update fails\",\n        boolean: true,\n        default: false,\n        alias: \"out\",\n    })\n    .option(\"registry\", {\n        describe: \"Specify a custom registry to use\",\n        alias: \"reg\",\n    })\n    .version()\n    .wrap(null)\n    .help().argv;\n","export default class Sequence {\n    constructor(name, updtr, baseEvent = {}) {\n        this.name = name;\n        this.updtr = updtr;\n        this.baseEvent = baseEvent;\n        this.isRunning = false;\n    }\n    start() {\n        this.isRunning = true;\n        this.emit(\"start\");\n    }\n    emit(eventName, event = {}) {\n        const fullEventName = this.name + \"/\" + eventName;\n\n        if (this.isRunning === false) {\n            throw new Error(\n                `Cannot emit event ${fullEventName}: sequence is not running`\n            );\n        }\n        this.updtr.emit(fullEventName, {\n            ...this.baseEvent,\n            ...event,\n        });\n    }\n    exec(step, cmd) {\n        this.emit(step, {cmd});\n\n        return this.updtr.exec(cmd);\n    }\n    end(result) {\n        this.emit(\"end\", result);\n        this.isRunning = false;\n    }\n}\n","import {\n    UPDATE_TO_LATEST,\n    UPDATE_TO_NON_BREAKING,\n    UPDATE_TO_WANTED,\n} from \"../../constants/config\";\n\nfunction determineUpdateToVersion({current, wanted, latest}, {updateTo}) {\n    switch (updateTo) {\n        case UPDATE_TO_LATEST:\n            return latest;\n        case UPDATE_TO_WANTED:\n            return wanted;\n        case UPDATE_TO_NON_BREAKING:\n        default:\n            return \"^\" + current;\n    }\n}\n\nexport function isUpdateToNonBreaking(updateTask) {\n    return updateTask.updateTo === \"^\" + updateTask.rollbackTo;\n}\n\nexport default function createUpdateTask(outdated, updtrConfig) {\n    return {\n        name: outdated.name,\n        updateTo: determineUpdateToVersion(outdated, updtrConfig),\n        rollbackTo: outdated.current,\n    };\n}\n","export const GIT = \"git\";\nexport const EXOTIC = \"exotic\";\nexport const UNSTABLE = \"unstable\";\nexport const EXCLUDED = \"excluded\";\nexport const NOT_WANTED = \"not-wanted\";\n","import semver from \"semver\";\nimport {\n    GIT,\n    UNSTABLE,\n    NOT_WANTED,\n    EXCLUDED,\n    EXOTIC,\n} from \"../../constants/filterReasons\";\nimport {isUpdateToNonBreaking} from \"./createUpdateTask\";\n\nconst prePattern = /^pre/;\nconst reasonTests = [\n    {\n        name: EXCLUDED,\n        test: (updateTask, {exclude}) =>\n            exclude.some(name => updateTask.name === name) === true,\n    },\n    {\n        name: GIT,\n        test: updateTask => updateTask.updateTo === \"git\",\n    },\n    {\n        name: EXOTIC,\n        test: updateTask => updateTask.updateTo === \"exotic\",\n    },\n    {\n        name: NOT_WANTED,\n        test: updateTask =>\n            isUpdateToNonBreaking(updateTask) === false &&\n            semver.lte(updateTask.updateTo, updateTask.rollbackTo) === true,\n    },\n    {\n        name: UNSTABLE,\n        test(updateTask) {\n            if (isUpdateToNonBreaking(updateTask) === true) {\n                return null;\n            }\n\n            const diff = semver.diff(\n                updateTask.rollbackTo,\n                updateTask.updateTo\n            );\n            const unstableTest = diff !== null &&\n                prePattern.test(diff) === true &&\n                diff !== \"prerelease\";\n\n            return unstableTest === true;\n        },\n    },\n];\nconst reasons = reasonTests.map(test => test.name);\n\nexport default function filterUpdateTask(updateTask, updtrConfig) {\n    const reasonIndex = reasonTests.findIndex(\n        reasonTest => reasonTest.test(updateTask, updtrConfig) === true\n    );\n\n    return reasonIndex === -1 ? null : reasons[reasonIndex];\n}\n","import {PackageJsonNoAccessError} from \"../errors\";\nimport Sequence from \"./util/Sequence\";\nimport createUpdateTask from \"./util/createUpdateTask\";\nimport filterUpdateTask from \"./util/filterUpdateTask\";\n\nfunction getUpdateTasksFromStdout(updtr, outdatedCmd, stdout) {\n    if (stdout.length === 0) {\n        // When there is not stdout, there is nothing to update\n        return [];\n    }\n\n    return updtr.parse\n        .outdated(stdout, outdatedCmd)\n        .map(outdated => createUpdateTask(outdated, updtr.config));\n}\n\nexport default (async function init(updtr) {\n    const baseEvent = {config: updtr.config};\n    const outdatedCmd = updtr.cmds.outdated();\n    const sequence = new Sequence(\"init\", updtr, baseEvent);\n    let stdout;\n\n    sequence.start();\n\n    if ((await updtr.canAccessPackageJson()) === false) {\n        throw new PackageJsonNoAccessError(updtr.config.cwd);\n    }\n\n    await sequence.exec(\n        \"install-missing\",\n        updtr.cmds.installMissing({\n            registry: updtr.config.registry,\n        })\n    );\n\n    try {\n        stdout = (await sequence.exec(\"collect\", outdatedCmd)).stdout;\n    } catch (err) {\n        // npm exits with zero code 1 when there are outdated dependencies\n        // We don't check for the package manager here because yarn might change their\n        // behavior in the future to be npm-compatible.\n        if (err.code > 1) {\n            throw err;\n        }\n\n        stdout = err.stdout;\n    }\n\n    const allUpdateTasks = getUpdateTasksFromStdout(\n        updtr,\n        outdatedCmd,\n        stdout.trim()\n    );\n    const filterResults = allUpdateTasks.map(updateTask =>\n        filterUpdateTask(updateTask, updtr.config));\n    const result = {\n        updateTasks: allUpdateTasks.filter(\n            (updateTask, index) => filterResults[index] === null\n        ),\n        excluded: allUpdateTasks.reduce(\n            (excluded, updateTask, index) => {\n                const reason = filterResults[index];\n\n                if (reason === null) {\n                    return excluded;\n                }\n\n                return excluded.concat({\n                    ...updateTask,\n                    reason,\n                });\n            },\n            []\n        ),\n    };\n\n    sequence.end(result);\n\n    return result;\n});\n","export default function createUpdateResult(updateTask, success) {\n    return {\n        name: updateTask.name,\n        updateTo: updateTask.updateTo,\n        rollbackTo: updateTask.rollbackTo,\n        success,\n    };\n}\n","export default function updateTo(updateTask) {\n    return {\n        name: updateTask.name,\n        version: updateTask.updateTo,\n    };\n}\n","export default function rollbackTo(updateTask) {\n    return {\n        name: updateTask.name,\n        version: updateTask.rollbackTo,\n    };\n}\n","import Sequence from \"./util/Sequence\";\nimport createUpdateResult from \"./util/createUpdateResult\";\nimport updateTo from \"./util/updateTo\";\nimport rollbackTo from \"./util/rollbackTo\";\n\nfunction renderUpdate(updtr, updateTask) {\n    return updtr.cmds.install({\n        registry: updtr.config.registry,\n        modules: [updateTo(updateTask)],\n    });\n}\n\nfunction renderTest(updtr) {\n    return updtr.cmds.test();\n}\n\nfunction renderRollback(updtr, failedUpdateTask, nextUpdateTask) {\n    const modules = [rollbackTo(failedUpdateTask)];\n\n    if (nextUpdateTask !== undefined) {\n        modules.push(updateTo(nextUpdateTask));\n    }\n\n    return updtr.cmds.install({\n        registry: updtr.config.registry,\n        modules,\n    });\n}\n\nasync function runUpdateTask(sequence, updateTasks, i, previousUpdateResults) {\n    const updateResults = await previousUpdateResults;\n    const previousUpdateResult = updateResults[updateResults.length - 1];\n    const updateTask = updateTasks[i];\n    // If the previous update was a failure, we don't need to update now because\n    // during the rollback, the next update is also installed in parallel\n    const updateNecessary = previousUpdateResult === undefined ?\n        true :\n        previousUpdateResult.success === true;\n\n    sequence.baseEvent = {\n        updateTasks: {\n            current: i + 1,\n            total: updateTasks.length,\n        },\n        ...updateTask,\n    };\n    const updtr = sequence.updtr;\n    let testResult;\n    let success;\n\n    if (updateNecessary === true) {\n        await sequence.exec(\"updating\", renderUpdate(updtr, updateTask));\n    }\n\n    try {\n        testResult = await sequence.exec(\"testing\", renderTest(updtr));\n        success = true;\n    } catch (err) {\n        // Remember: instanceof Error might not work in Jest as expected\n        // https://github.com/facebook/jest/issues/2549\n        testResult = err;\n        success = false;\n    }\n\n    sequence.baseEvent.success = success;\n\n    if (success === false) {\n        const nextUpdateTask = i + 1 < updateTasks.length ?\n            updateTasks[i + 1] :\n            undefined;\n\n        await sequence.exec(\n            \"rollback\",\n            renderRollback(updtr, updateTask, nextUpdateTask)\n        );\n    }\n\n    sequence.emit(\"result\", {\n        stdout: testResult.stdout,\n    });\n\n    return updateResults.concat(createUpdateResult(updateTask, success));\n}\n\nexport default (async function sequentialUpdate(\n    updtr,\n    updateTasks,\n    previousUpdateResult\n) {\n    const sequence = new Sequence(\"sequential-update\", updtr, {\n        updateTasks,\n    });\n\n    if (updateTasks.length === 0) {\n        return [];\n    }\n\n    sequence.start();\n\n    const updateResults = await updateTasks.reduce(\n        (updateResults, updateTask, i) =>\n            runUpdateTask(sequence, updateTasks, i, updateResults),\n        previousUpdateResult === undefined ? [] : [previousUpdateResult]\n    );\n\n    if (previousUpdateResult !== undefined) {\n        // The previousUpdateResult is the first element in the updateResults array, so let's remove it.\n        updateResults.shift();\n    }\n\n    sequence.baseEvent = {\n        updateResults,\n    };\n\n    sequence.end();\n\n    return updateResults;\n});\n","import semver from \"semver\";\nimport {isUpdateToNonBreaking} from \"./createUpdateTask\";\n\nfunction isBreaking(updateTask) {\n    return isUpdateToNonBreaking(updateTask) === false &&\n        semver.satisfies(updateTask.updateTo, \"^\" + updateTask.rollbackTo) ===\n            false;\n}\n\nexport default function splitUpdateTask(updateTasks) {\n    const breaking = [];\n    const nonBreaking = [];\n\n    for (const updateTask of updateTasks) {\n        (isBreaking(updateTask) === true ? breaking : nonBreaking).push(\n            updateTask\n        );\n    }\n\n    return {\n        breaking,\n        nonBreaking,\n    };\n}\n","import Sequence from \"./util/Sequence\";\nimport updateTo from \"./util/updateTo\";\nimport rollbackTo from \"./util/rollbackTo\";\n\nfunction renderUpdate(updtr, updateTask) {\n    return updtr.cmds.install({\n        registry: updtr.config.registry,\n        modules: updateTask.map(updateTo),\n    });\n}\n\nfunction renderTest(updtr) {\n    return updtr.cmds.test();\n}\n\nfunction renderRollback(updtr, failedUpdateTasks) {\n    return updtr.cmds.install({\n        registry: updtr.config.registry,\n        modules: failedUpdateTasks.map(rollbackTo),\n    });\n}\n\nasync function update(sequence, updateTasks) {\n    const updtr = sequence.updtr;\n    let success;\n    let testResult;\n\n    await sequence.exec(\"updating\", renderUpdate(updtr, updateTasks));\n    try {\n        testResult = await sequence.exec(\"testing\", renderTest(updtr));\n        success = true;\n    } catch (err) {\n        // Remember: instanceof Error might not work in Jest as expected\n        // https://github.com/facebook/jest/issues/2549\n        testResult = err;\n        success = false;\n    }\n\n    sequence.baseEvent.success = success;\n\n    if (success === false && updateTasks.length > 1) {\n        // If the update was a failure, we roll back every update except the first.\n        // The first update will be tested with the sequential-update. This way we skip one unnecessary install cycle.\n        await sequence.exec(\n            \"rollback\",\n            renderRollback(updtr, updateTasks.slice(1))\n        );\n    }\n\n    sequence.emit(\"result\", {\n        stdout: testResult.stdout,\n    });\n\n    return success;\n}\n\nexport default (async function batchUpdate(updtr, updateTasks) {\n    const sequence = new Sequence(\"batch-update\", updtr, {\n        updateTasks,\n    });\n    let success = true;\n\n    if (updateTasks.length > 0) {\n        sequence.start();\n        success = await update(sequence, updateTasks);\n        sequence.baseEvent = {\n            success,\n        };\n        sequence.end();\n    }\n\n    return success;\n});\n","import Sequence from \"./util/Sequence\";\nimport {isUpdateToNonBreaking} from \"./util/createUpdateTask\";\n\nfunction isIncompleteResult(result) {\n    return result.success === true && isUpdateToNonBreaking(result) === true;\n}\n\nasync function finishIncomplete(sequence, incomplete, allResults) {\n    const updtr = sequence.updtr;\n    const modulesToCheck = incomplete.map(result => result.name);\n    const listCmd = updtr.cmds.list({modules: modulesToCheck});\n    let stdout;\n\n    try {\n        stdout = (await sequence.exec(\"list-incomplete\", listCmd)).stdout;\n    } catch (err) {\n        // npm may exit with zero code 1 complaining about invalid installed versions\n        if (err.code > 1) {\n            throw err;\n        }\n        stdout = err.stdout;\n    }\n    const moduleVersions = updtr.parse.list(stdout, listCmd);\n\n    return (\n        allResults\n            .map(result => {\n                if (isIncompleteResult(result) === false) {\n                    return result;\n                }\n\n                const version = moduleVersions.find(\n                    module => module.name === result.name\n                ).version;\n\n                return {\n                    ...result,\n                    updateTo: version,\n                };\n            })\n        // Remove results where no actual update did happen.\n        // These results can happen if the updateTo option was set to non-breaking\n        // and the module did not have a new version for the rollbackTo version range.\n            .filter(result => result.rollbackTo !== result.updateTo)\n    );\n}\n\nexport default (async function finish(updtr, results) {\n    const incomplete = results.filter(isIncompleteResult);\n    const sequence = new Sequence(\"finish\", updtr);\n    let finishedResults = results;\n\n    if (incomplete.length > 0) {\n        sequence.start();\n        sequence.emit(\"incomplete\", {incomplete});\n        finishedResults = await finishIncomplete(sequence, incomplete, results);\n        sequence.end({results: finishedResults});\n    }\n\n    return finishedResults;\n});\n","import semver from \"semver\";\n\n// Matches a semver version range that can be transformed to the new version in a safe manner\nconst expectedSemverPattern = /^(\\^|~|>=|)(\\d+)\\.(\\d+|x|\\*)\\.(\\d+|x|\\*)(-[a-z][a-z\\-.\\d]+|)$/i;\nconst numberPattern = /^\\d+$/;\n\nfunction parse(semverString) {\n    const match = semverString.match(expectedSemverPattern);\n\n    return match === null ?\n        null :\n        {\n            operator: match[1],\n            major: match[2],\n            minor: match[3],\n            patch: match[4],\n            release: match[5],\n        };\n}\n\nfunction isPinned({operator, major, minor, patch}) {\n    return operator === \"\" &&\n        [major, minor, patch].every(\n            version => numberPattern.test(version) === true\n        );\n}\n\nfunction tryVersionRangeUpdate(parsedOldRange, parsedNewVersion) {\n    const {minor, patch, operator} = parsedOldRange;\n    let newMinor = parsedNewVersion.minor;\n    let newPatch = parsedNewVersion.patch;\n\n    if (numberPattern.test(minor) === false) {\n        newMinor = minor;\n        newPatch = numberPattern.test(patch) === true ? minor : patch;\n    } else if (numberPattern.test(patch) === false) {\n        newPatch = patch;\n    }\n\n    return operator +\n        parsedNewVersion.major +\n        \".\" +\n        newMinor +\n        \".\" +\n        newPatch +\n        parsedNewVersion.release;\n}\n\nfunction isExpectedNewVersion(parsedNewVersion) {\n    return parsedNewVersion !== null && parsedNewVersion.operator === \"\";\n}\n\nfunction fallbackRange(newVersion) {\n    return \"^\" + newVersion;\n}\n\n/**\n * Tries to apply the newVersion while maintaining the range (see https://github.com/peerigon/updtr/issues/47)\n * This is kind of risky because there are tons of semver possibilities. That's why this\n * function is very conservative in accepting semver ranges. If the range is not easily updatable,\n * we opt-out to npm's default caret operator.\n *\n * @param {string} oldRange\n * @param {string} newVersion\n * @returns {string}\n */\nexport default function updateVersionRange(oldRange, newVersion) {\n    const parsedOldRange = parse(oldRange.trim());\n\n    if (parsedOldRange !== null) {\n        if (isPinned(parsedOldRange) === true) {\n            // The old version was pinned, so the new should also be pinned\n            return newVersion;\n        }\n\n        const parsedNewVersion = parse(newVersion);\n\n        if (isExpectedNewVersion(parsedNewVersion) === false) {\n            return newVersion;\n        }\n\n        const newVersionRange = tryVersionRangeUpdate(\n            parsedOldRange,\n            parsedNewVersion\n        );\n\n        // All this is kind of error prone so let's do a sanity check if everything's ok\n        if (semver.satisfies(newVersion, newVersionRange) === true) {\n            return newVersionRange;\n        }\n    }\n\n    return fallbackRange(newVersion);\n}\n","import {SAVE_CARET, SAVE_EXACT, SAVE_SMART} from \"../../constants/config\";\nimport updateVersionRange from \"./updateVersionRange\";\nimport {filterSuccessfulUpdates} from \"./filterUpdateResults\";\n\nconst dependencyTypes = [\n    \"dependencies\",\n    \"devDependencies\",\n    \"optionalDependencies\",\n];\n\nfunction newVersionRange(updtrConfig, oldVersionRange, update) {\n    switch (updtrConfig.save) {\n        case SAVE_CARET:\n            return \"^\" + update.updateTo;\n        case SAVE_EXACT:\n            return update.updateTo;\n        case SAVE_SMART:\n    }\n\n    return updateVersionRange(oldVersionRange, update.updateTo);\n}\n\nexport default function createUpdatedPackageJson(\n    oldPackageJson,\n    updateResults,\n    updtrConfig\n) {\n    const newPackageJson = {...oldPackageJson};\n    const successfulUpdates = filterSuccessfulUpdates(updateResults);\n    let dependenciesToSave = successfulUpdates;\n\n    dependencyTypes\n        .filter(type => oldPackageJson[type] !== undefined)\n        .forEach(type => {\n            const dependencies = oldPackageJson[type];\n            const newDependencies = {};\n\n            Object.keys(dependencies).forEach(moduleName => {\n                const update = successfulUpdates.find(\n                    ({name}) => name === moduleName\n                );\n                const oldVersionRange = dependencies[moduleName];\n\n                newDependencies[moduleName] = update === undefined ?\n                    oldVersionRange :\n                    newVersionRange(updtrConfig, oldVersionRange, update);\n\n                dependenciesToSave = dependenciesToSave.filter(\n                    ({name}) => name !== moduleName\n                );\n            });\n\n            newPackageJson[type] = newDependencies;\n        });\n\n    if (dependenciesToSave.length > 0) {\n        const dependencies = newPackageJson.dependencies || {};\n\n        dependenciesToSave.forEach(update => {\n            dependencies[update.name] = update.updateTo;\n        });\n\n        newPackageJson.dependencies = dependencies;\n    }\n\n    return newPackageJson;\n}\n","import createUpdatedPackageJson from \"./util/createUpdatedPackageJson\";\nimport Sequence from \"./util/Sequence\";\n\nfunction lastChar(str) {\n    return str.charAt(str.length - 1);\n}\n\nfunction stringify(newPackageJson, oldPackageJsonStr) {\n    let newPackageJsonStr = JSON.stringify(newPackageJson, null, \"  \");\n    const lastCharFromOldPackageJson = lastChar(oldPackageJsonStr);\n\n    // Preserve the new line character at the end if there was one\n    if (lastCharFromOldPackageJson !== lastChar(newPackageJsonStr)) {\n        newPackageJsonStr += lastCharFromOldPackageJson;\n    }\n\n    return newPackageJsonStr;\n}\n\nasync function enhanceErrorMessage(fn, enhancedMessage) {\n    try {\n        return await fn();\n    } catch (err) {\n        err.message = enhancedMessage + err.message;\n        throw err;\n    }\n}\n\nexport default (async function updatePackageJson(updtr, updateResults) {\n    const sequence = new Sequence(\"update-package-json\", updtr);\n    let oldPackageJsonStr;\n\n    sequence.start();\n\n    const oldPackageJson = await enhanceErrorMessage(\n        async () => {\n            oldPackageJsonStr = await updtr.readFile(\"package.json\");\n\n            return JSON.parse(oldPackageJsonStr);\n        },\n        \"Error while trying to read the package.json: \"\n    );\n    const newPackageJson = createUpdatedPackageJson(\n        oldPackageJson,\n        updateResults,\n        updtr.config\n    );\n\n    await enhanceErrorMessage(\n        () =>\n            updtr.writeFile(\n                \"package.json\",\n                stringify(newPackageJson, oldPackageJsonStr)\n            ),\n        \"Error while trying to write the package.json: \"\n    );\n\n    sequence.end({\n        packageJson: newPackageJson,\n    });\n});\n","import init from \"./tasks/init\";\nimport sequentialUpdate from \"./tasks/sequentialUpdate\";\nimport splitUpdateTasks from \"./tasks/util/splitUpdateTasks\";\nimport batchUpdate from \"./tasks/batchUpdate\";\nimport createUpdateResult from \"./tasks/util/createUpdateResult\";\nimport finish from \"./tasks/finish\";\nimport updatePackageJson from \"./tasks/updatePackageJson\";\n\nasync function runUpdateTasks(updtr, updateTasks) {\n    const results = [];\n    const {breaking, nonBreaking} = splitUpdateTasks(updateTasks);\n    const sequentialUpdateTasks = breaking.slice();\n    let batchSuccess; // can be undefined, true or false\n    let batchUpdateFailure;\n\n    // Run batch update if we have more than one non-breaking update\n    // If the batch update fails, it will roll back all modules except the first one.\n    // This way we can skip one install command since we will run the sequential update for it anyway.\n    if (nonBreaking.length > 1) {\n        batchSuccess = await batchUpdate(updtr, nonBreaking);\n    }\n\n    if (batchSuccess === true) {\n        results.push(\n            ...nonBreaking.map(updateTask =>\n                createUpdateResult(updateTask, true)\n            )\n        );\n    } else {\n        sequentialUpdateTasks.unshift(...nonBreaking);\n        // If batchSuccess is false, we have actually executed the batch update and it returned false\n        if (batchSuccess === false) {\n            batchUpdateFailure = createUpdateResult(nonBreaking[0], false);\n        }\n    }\n\n    // Run sequential update for all breaking updates and non-breaking batch updates that failed\n    results.push(\n        ...(await sequentialUpdate(\n            updtr,\n            sequentialUpdateTasks,\n            batchUpdateFailure\n        ))\n    );\n\n    return finish(updtr, results);\n}\n\nexport default (async function run(updtr) {\n    const results = [];\n\n    updtr.emit(\"start\", {\n        config: updtr.config,\n    });\n\n    const {updateTasks} = await init(updtr);\n\n    if (updateTasks.length > 0) {\n        results.push(...(await runUpdateTasks(updtr, updateTasks)));\n        await updatePackageJson(updtr, results);\n    }\n\n    updtr.emit(\"end\", {\n        config: updtr.config,\n        results,\n    });\n\n    return results;\n});\n","import fs from \"fs\";\nimport pify from \"pify\";\n\nexport default pify(fs);\n","import childProcess from \"child_process\";\n\nfunction promiseExec(cwd, cmd) {\n    return new Promise(resolve => {\n        childProcess.exec(\n            cmd,\n            {maxBuffer: Infinity, encoding: \"utf8\", cwd},\n            // We need to use the callback API here\n            (err, stdout, stderr) => void resolve({err, stdout, stderr}) // eslint-disable-line promise/prefer-await-to-callbacks\n        );\n    });\n}\n\nexport default (async function exec(cwd, cmd) {\n    const {err, stdout, stderr} = await promiseExec(cwd, cmd);\n\n    if (err !== null) {\n        err.stdout = stdout;\n        err.stderr = stderr;\n\n        throw err;\n    }\n\n    return {stdout, stderr};\n});\n","function installFn(baseCmd) {\n    return ({registry, modules} = {}) =>\n        [baseCmd, stringifyRegistry(registry), stringifyModules(modules)].join(\n            \"\"\n        );\n}\n\nfunction stringifyModules(modules) {\n    return Array.isArray(modules) === true ?\n        \" \" +\n              modules\n                  // We need to wrap this in double-quotes because some semver\n                  // characters like the caret symbol are reserved characters on Windows.\n                  .map(({name, version}) => `\"${name}@${version}\"`)\n                  .join(\" \") :\n        \"\";\n}\n\nfunction stringifyRegistry(registry) {\n    return registry === undefined ? \"\" : ` --registry \"${registry}\"`;\n}\n\nconst cmds = {\n    npm: {\n        outdated: () => \"npm outdated --json --depth=0\",\n        installMissing: installFn(\"npm install\"),\n        install: installFn(\"npm install\"),\n        // remove: ({ name }) => [\"npm remove \", name].join(\"\"),\n        test: () => \"npm test\",\n        list: ({modules} = {}) => [\n            \"npm ls --json --depth=0\",\n            Array.isArray(modules) === true ? \" \" + modules.join(\" \") : \"\",\n        ].join(\"\"),\n    },\n    // yarn does not support custom registries yet.\n    // However, these renderers accept them anyway.\n    yarn: {\n        outdated: () => \"yarn outdated --json --flat\",\n        installMissing: installFn(\"yarn\"),\n        install: installFn(\"yarn add\"),\n        // remove: ({ name }) => [\"yarn remove \", name].join(\"\"),\n        test: () => \"yarn test\",\n        list: ({modules} = {}) => [\n            \"yarn list --json --depth=0\",\n            Array.isArray(modules) === true ? \" \" + modules.join(\" \") : \"\",\n        ].join(\"\"),\n    },\n};\n\nexport default cmds;\n","import {EOL} from \"os\";\n\nconst STRING_PROPERTIES = [\"name\", \"current\", \"wanted\", \"latest\"];\n\nfunction isNotEmptyString(value) {\n    return typeof value === \"string\" && value.length > 0;\n}\n\nfunction returnIfValid(result) {\n    STRING_PROPERTIES.forEach(prop => {\n        if (isNotEmptyString(result[prop]) === false) {\n            throw new Error(\"Unexpected output format of package manager\");\n        }\n    });\n\n    return result;\n}\n\nfunction tryParse(parser) {\n    return (stdout, cmd) => {\n        try {\n            return parser(stdout);\n        } catch (err) {\n            err.message = `Error when trying to parse stdout from command '${cmd}': ${err.message}`;\n            throw err;\n        }\n    };\n}\n\nfunction arrToObj(arr, keys) {\n    return keys.reduce((obj, key, i) => {\n        obj[key] = arr[i];\n\n        return obj;\n    }, {});\n}\n\n// By sorting the parsed data, we get deterministic results across different npm and yarn versions.\n// As a nice side-effect, a package like eslint will always be updated before eslint-config-peerigon\n// which might have a peer dependency on eslint\n// See https://github.com/peerigon/updtr/issues/48\nfunction sortByName(o1, o2) {\n    return o1.name > o2.name;\n}\n\nfunction npmParser(stdout) {\n    const trimmed = stdout.trim();\n\n    if (trimmed.length === 0) {\n        return null;\n    }\n\n    return JSON.parse(trimmed);\n}\n\nfunction yarnParser(stdout, wantedTypeProperty) {\n    try {\n        return npmParser(stdout);\n    } catch (error) {\n        /* in some cases (e.g. when printing the outdated result), yarn prints for each line a separate JSON object */\n        /* in that case, we need to look for a { type: \"table\" } object which holds the interesting data to display */\n    }\n    const dataLine = stdout\n        .split(EOL)\n        .map(line => line.trim())\n        .filter(line => line !== \"\")\n        .find(line => {\n            try {\n                const parsedLine = JSON.parse(line);\n\n                return parsedLine.type === wantedTypeProperty;\n            } catch (error) {\n                return false;\n            }\n        });\n\n    if (dataLine === undefined) {\n        throw new Error(`Could not find object with type === ${wantedTypeProperty}`);\n    }\n\n    return JSON.parse(dataLine);\n}\n\nconst parse = {\n    npm: {\n        outdated: tryParse(stdout => {\n            const parsed = npmParser(stdout);\n\n            if (parsed === null) {\n                return [];\n            }\n\n            const names = Object.keys(parsed);\n\n            return names\n                .map(name => parsed[name])\n                .map((dep, index) =>\n                    returnIfValid({\n                        name: names[index],\n                        current: dep.current,\n                        wanted: dep.wanted,\n                        latest: dep.latest,\n                    })\n                )\n                .sort(sortByName);\n        }),\n        list: tryParse(stdout => {\n            const parsed = npmParser(stdout);\n\n            return (parsed.dependencies === undefined ?\n                [] :\n                Object.keys(parsed.dependencies)\n                    .map(name => ({\n                        name,\n                        version: parsed.dependencies[name].version,\n                    }))\n                    .sort(sortByName));\n        }),\n    },\n    yarn: {\n        outdated: tryParse(\n            stdout => {\n                const parsed = yarnParser(stdout, \"table\");\n\n                if (parsed === null) {\n                    return [];\n                }\n\n                return parsed.data.body\n                    .map(row => arrToObj(row, parsed.data.head))\n                    .map(dep =>\n                        returnIfValid({\n                            name: dep.Package,\n                            current: dep.Current,\n                            wanted: dep.Wanted,\n                            latest: dep.Latest,\n                        })\n                    )\n                    .sort(sortByName);\n            }\n        ),\n        list: tryParse(stdout => {\n            const parsed = yarnParser(stdout, \"tree\");\n\n            if (parsed.data.trees.length === 0) {\n                return [];\n            }\n\n            return parsed.data.trees\n                .map(dependency => {\n                    const [name, version] = dependency.name.split(\"@\");\n\n                    if (isNotEmptyString(name) === false || isNotEmptyString(version) === false) {\n                        throw new Error(`Could not parse dependency name \"${dependency.name}\"`);\n                    }\n\n                    return {\n                        name,\n                        version,\n                    };\n                })\n                .sort(sortByName);\n        }),\n    },\n};\n\nexport default parse;\n","import EventEmitter from \"events\";\nimport path from \"path\";\nimport fs from \"./util/fs\";\nimport {\n    USE_OPTIONS,\n    UPDATE_TO_OPTIONS,\n    SAVE_OPTIONS,\n} from \"./constants/config\";\nimport exec from \"./exec/exec\";\nimport cmds from \"./exec/cmds\";\nimport parse from \"./exec/parse\";\nimport {\n    RequiredOptionMissingError,\n    OptionValueNotSupportedError,\n    YarnWithCustomRegistryError,\n} from \"./errors\";\n\n// node v4 has no dedicated constants object.\n// Remove this if node v4 is not supported anymore.\nconst FS_CONSTANTS = fs.constants === undefined ? fs : fs.constants;\n\nfunction checkCwd(cwd) {\n    if (typeof cwd !== \"string\") {\n        throw new RequiredOptionMissingError(\"cwd\", cwd);\n    }\n}\n\nfunction checkUse(use) {\n    if (USE_OPTIONS.indexOf(use) === -1) {\n        throw new OptionValueNotSupportedError(\"use\", use);\n    }\n}\n\nfunction checkUpdateTo(updateTo) {\n    if (UPDATE_TO_OPTIONS.indexOf(updateTo) === -1) {\n        throw new OptionValueNotSupportedError(\"updateTo\", updateTo);\n    }\n}\n\nfunction checkSave(save) {\n    if (SAVE_OPTIONS.indexOf(save) === -1) {\n        throw new OptionValueNotSupportedError(\"save\", save);\n    }\n}\n\nfunction checkForYarnWithCustomReg(packageManager, registry) {\n    if (packageManager === \"yarn\" && registry !== undefined) {\n        throw new YarnWithCustomRegistryError();\n    }\n}\n\nexport default class Updtr extends EventEmitter {\n    // TODO: Add typings for UpdtrConfig\n    // eslint-disable-next-line\n    /**\n     * The config passed-in here should look identically to the CLI config.\n     * Dash-cased properties should be renamed to camelCased.\n     * The goal is to replicate the API of the CLI as close as possible so users don't\n     * have to guess the options.\n     *\n     * @param {UpdtrConfig} config\n     */\n    constructor(config) {\n        super();\n\n        const cwd = config.cwd;\n        const registry = config.registry;\n        const packageManager = config.use === undefined ?\n            USE_OPTIONS[0] :\n            config.use;\n        const updateTo = config.updateTo === undefined ?\n            UPDATE_TO_OPTIONS[0] :\n            config.updateTo;\n        const exclude = Array.isArray(config.exclude) === true ?\n            config.exclude :\n            [];\n        const save = config.save === undefined ? SAVE_OPTIONS[0] : config.save;\n\n        checkCwd(cwd);\n        checkUse(packageManager);\n        checkForYarnWithCustomReg(packageManager, registry);\n        checkUpdateTo(updateTo);\n        checkSave(save);\n\n        this.config = {\n            cwd,\n            use: packageManager,\n            exclude,\n            test: config.test,\n            registry,\n            updateTo,\n            save,\n        };\n        this.cmds = cmds[packageManager];\n        this.parse = parse[packageManager];\n\n        if (typeof config.test === \"string\") {\n            this.cmds = {\n                ...this.cmds,\n                test: () => config.test,\n            };\n        }\n    }\n    async canAccessPackageJson() {\n        let result = true;\n\n        try {\n            await fs.access(\n                path.join(this.config.cwd, \"package.json\"),\n                FS_CONSTANTS.R_OK | FS_CONSTANTS.W_OK // eslint-disable-line no-bitwise\n            );\n        } catch (err) {\n            result = false;\n        }\n\n        return result;\n    }\n    exec(cmd) {\n        return exec(this.config.cwd, cmd);\n    }\n    readFile(filenameInCwd) {\n        return fs.readFile(path.join(this.config.cwd, filenameInCwd), \"utf8\");\n    }\n    writeFile(filenameInCwd, contents) {\n        return fs.writeFile(\n            path.join(this.config.cwd, filenameInCwd),\n            contents\n        );\n    }\n    dispose() {\n        this.removeAllListeners();\n    }\n}\n","import run from \"./run\";\nimport Updtr from \"./Updtr\";\nimport * as errors from \"./errors\";\n\nexport function create(config) {\n    return new Updtr(config);\n}\n\nexport {errors, run};\n","import reporters from \"../reporters\";\nimport argv from \"./argv\";\nimport {create, run} from \"..\";\n\nasync function start() {\n    const cwd = process.cwd();\n    const config = {...argv};\n    const reporterConfig = {\n        stream: process.stdout,\n        testStdout: argv.testStdout,\n    };\n    const reporter = reporters[argv.reporter];\n\n    config.cwd = cwd;\n\n    const updtr = create(config);\n\n    reporter(updtr, reporterConfig);\n    try {\n        await run(updtr);\n    } catch (err) {\n        updtr.emit(\"error\", err);\n    }\n}\n\nstart();\n"],"names":["filterSuccessfulUpdates","results","filter","result","success","filterFailedUpdates","lineToString","line","Array","isArray","join","String","Projector","constructor","terminal","frameRate","delay","Math","floor","timeoutId","display","frame","stop","append","map","setTimeout","rewind","clearTimeout","calcNumOfRows","lines","columns","lineContent","ceil","stringWidth","reduce","allRows","rows","setBlocking","stream","_handle","Terminal","isTTY","Error","cliCursor","hide","hasBeenResized","on","length","push","content","ansiEscapes","clearScreen","eraseDown","write","removedLines","pop","cursorUp","Message","template","variables","valueOf","split","str","part","i","toString","isWin","process","platform","winFallback","Spinner","spinnerName","spinner","cliSpinners","frames","interval","max","currentInterval","Date","now","currentFrame","INDICATOR_NEUTRAL","INDICATOR_FAIL","INDICATOR_PENDING","INDICATOR_OK","COLORS","chalk","grey","red","yellow","green","Indicator","initialState","state","unicons","cli","USE_NPM","USE_YARN","USE_OPTIONS","UPDATE_TO_LATEST","UPDATE_TO_NON_BREAKING","UPDATE_TO_WANTED","UPDATE_TO_OPTIONS","SAVE_SMART","SAVE_CARET","SAVE_EXACT","SAVE_OPTIONS","configNames","use","exclude","test","registry","updateTo","save","configValues","list","configFilter","cwd","option","cmd","undefined","reg","configList","config","Object","keys","key","name","customConfigToLines","item","pluralize","num","PackageJsonNoAccessError","dir","RequiredOptionMissingError","optionName","optionValue","OptionValueNotSupportedError","unsupportedValue","YarnWithCustomRegistryError","ERROR","bgRed","bold","handleError","err","stack","shift","message","console","error","exit","msToString","milliseconds","toFixed","updatingLine","updateTask","rollbackTo","arrowRight","testingLine","rollbackLine","successLine","failLine","excludedLine","excluded","reason","cmdToLines","description","concat","dense","updtr","reporterConfig","projector","startTime","excludedModules","updateTasks","event","testStdout","stdout","duration","successful","failed","Function","prototype","reporters","none","reporterNames","pathToYarnLock","path","useDefault","fs","existsSync","yargs","usage","cyan","dim","EOL","describe","choices","default","alias","array","boolean","version","wrap","help","argv","Sequence","baseEvent","isRunning","start","emit","eventName","fullEventName","exec","step","end","determineUpdateToVersion","current","wanted","latest","isUpdateToNonBreaking","createUpdateTask","outdated","updtrConfig","GIT","EXOTIC","UNSTABLE","EXCLUDED","NOT_WANTED","prePattern","reasonTests","some","semver","lte","diff","unstableTest","reasons","filterUpdateTask","reasonIndex","findIndex","reasonTest","getUpdateTasksFromStdout","outdatedCmd","parse","cmds","sequence","canAccessPackageJson","installMissing","code","allUpdateTasks","trim","filterResults","index","init","createUpdateResult","renderUpdate","install","modules","renderTest","renderRollback","failedUpdateTask","nextUpdateTask","runUpdateTask","previousUpdateResults","updateResults","previousUpdateResult","updateNecessary","total","testResult","sequentialUpdate","isBreaking","satisfies","splitUpdateTask","breaking","nonBreaking","failedUpdateTasks","update","slice","batchUpdate","isIncompleteResult","finishIncomplete","incomplete","allResults","modulesToCheck","listCmd","moduleVersions","find","module","finishedResults","finish","expectedSemverPattern","numberPattern","semverString","match","operator","major","minor","patch","release","isPinned","every","tryVersionRangeUpdate","parsedOldRange","parsedNewVersion","newMinor","newPatch","isExpectedNewVersion","fallbackRange","newVersion","updateVersionRange","oldRange","newVersionRange","dependencyTypes","oldVersionRange","createUpdatedPackageJson","oldPackageJson","newPackageJson","successfulUpdates","dependenciesToSave","type","forEach","dependencies","newDependencies","moduleName","lastChar","charAt","stringify","oldPackageJsonStr","newPackageJsonStr","JSON","lastCharFromOldPackageJson","enhanceErrorMessage","fn","enhancedMessage","readFile","writeFile","packageJson","updatePackageJson","runUpdateTasks","splitUpdateTasks","sequentialUpdateTasks","batchSuccess","batchUpdateFailure","unshift","run","pify","promiseExec","Promise","resolve","childProcess","maxBuffer","Infinity","encoding","stderr","installFn","baseCmd","stringifyRegistry","stringifyModules","npm","yarn","STRING_PROPERTIES","isNotEmptyString","value","returnIfValid","prop","tryParse","parser","arrToObj","arr","obj","sortByName","o1","o2","npmParser","trimmed","yarnParser","wantedTypeProperty","dataLine","parsedLine","parsed","names","dep","sort","data","body","row","head","Package","Current","Wanted","Latest","trees","dependency","FS_CONSTANTS","constants","checkCwd","checkUse","indexOf","checkUpdateTo","checkSave","checkForYarnWithCustomReg","packageManager","Updtr","EventEmitter","access","R_OK","W_OK","filenameInCwd","contents","dispose","removeAllListeners","create","reporter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAO,SAASA,uBAAT,CAAiCC,OAAjC,EAA0C;SACtCA,OAAO,CAACC,MAAR,CAAeC,MAAM,IAAIA,MAAM,CAACC,OAAP,KAAmB,IAA5C,CAAP;;;AAGJ,AAAO,SAASC,mBAAT,CAA6BJ,OAA7B,EAAsC;SAClCA,OAAO,CAACC,MAAR,CAAeC,MAAM,IAAIA,MAAM,CAACC,OAAP,KAAmB,KAA5C,CAAP;;;ACLJ,SAASE,YAAT,CAAsBC,IAAtB,EAA4B;MACpBC,KAAK,CAACC,OAAN,CAAcF,IAAd,MAAwB,IAA5B,EAAkC;WACvBA,IAAI,CAACG,IAAL,CAAU,EAAV,CAAP;;;SAGGC,MAAM,CAACJ,IAAD,CAAb;;;AAGJ,AAAe,MAAMK,SAAN,CAAgB;EAC3BC,WAAW,CAACC,QAAD,EAAWC,SAAS,GAAG,EAAvB,EAA2B;SAC7BD,QAAL,GAAgBA,QAAhB;SACKE,KAAL,GAAaC,IAAI,CAACC,KAAL,CAAW,OAAOH,SAAlB,CAAb;SACKI,SAAL,GAAiB,IAAjB;;EAEJC,OAAO,CAACC,KAAD,EAAQ;QACP,KAAKF,SAAL,KAAmB,IAAvB,EAA6B;WACpBG,IAAL;;SAECR,QAAL,CAAcS,MAAd,CAAqBF,KAAK,CAACG,GAAN,CAAUlB,YAAV,CAArB;SACKa,SAAL,GAAiBM,UAAU,CAAC,MAAM;WACzBL,OAAL,CAAaC,KAAb;KADuB,EAExB,KAAKL,KAFmB,CAA3B;;EAIJM,IAAI,GAAG;QACC,KAAKH,SAAL,KAAmB,IAAvB,EAA6B;;;SAGxBL,QAAL,CAAcY,MAAd;IACAC,YAAY,CAAC,KAAKR,SAAN,CAAZ;SACKA,SAAL,GAAiB,IAAjB;GArBuB;;ACJ/B,SAASS,aAAT,CAAuBC,KAAvB,EAA8BC,OAA9B,EAAuC;SAC5BD,KAAK;EACPL,GADE,CACEO,WAAW,IAAId,IAAI,CAACe,IAAL,CAAUC,WAAW,CAACF,WAAD,CAAX,GAA2BD,OAArC,CADjB;EAEFI,MAFE,CAEK,CAACC,OAAD,EAAUC,IAAV,KAAmBD,OAAO,GAAGC,IAFlC,EAEwC,CAFxC,CAAP;;;;;AAOJ,SAASC,WAAT,CAAqBC,MAArB,EAA6B;MACrBA,MAAM,CAACC,OAAP,IAAkB,OAAOD,MAAM,CAACC,OAAP,CAAeF,WAAtB,KAAsC,UAA5D,EAAwE;IACpEC,MAAM,CAACC,OAAP,CAAeF,WAAf,CAA2B,IAA3B;;;;AAIR,AAAe,MAAMG,QAAN,CAAe;EAC1B3B,WAAW,CAACyB,MAAD,EAAS;QACZA,MAAM,CAACG,KAAP,KAAiB,IAArB,EAA2B;YACjB,IAAIC,KAAJ,CAAU,kCAAV,CAAN;;IAEJL,WAAW,CAACC,MAAD,CAAX;IACAK,SAAS,CAACC,IAAV,CAAeN,MAAf;SACKA,MAAL,GAAcA,MAAd;SACKT,KAAL,GAAa,EAAb;SACKgB,cAAL,GAAsB,KAAtB;SACKP,MAAL,CAAYQ,EAAZ,CAAe,QAAf,EAAyB,MAAM;WACtBD,cAAL,GAAsB,IAAtB;KADJ;;EAIJtB,MAAM,CAACM,KAAD,EAAQ;QACNA,KAAK,CAACkB,MAAN,KAAiB,CAArB,EAAwB;;;SAGnBlB,KAAL,CAAWmB,IAAX,CAAgBnB,KAAhB;;UAEMoB,OAAO,GAAG,KAAKJ,cAAL,KAAwB,IAAxB;IACZK,WAAW,CAACC,WAAZ;SACWtB,KAAL,CAAWL,GAAX,CAAeK,KAAK,IAAIA,KAAK,CAACnB,IAAN,CAAW,IAAX,CAAxB,EAA0CA,IAA1C,CAA+C,IAA/C,CAFM;IAGZwC,WAAW,CAACE,SAAZ,GAAwBvB,KAAK,CAACnB,IAAN,CAAW,IAAX,CAH5B;;SAKK4B,MAAL,CAAYe,KAAZ,CAAkBJ,OAAO,GAAG,IAA5B;SACKJ,cAAL,GAAsB,KAAtB;;EAEJnB,MAAM,GAAG;UACC4B,YAAY,GAAG,KAAKzB,KAAL,CAAW0B,GAAX,EAArB;UACMnB,IAAI,GAAGR,aAAa,CAAC0B,YAAD,EAAe,KAAKhB,MAAL,CAAYR,OAA3B,CAA1B;;SAEKQ,MAAL,CAAYe,KAAZ,CAAkBH,WAAW,CAACM,QAAZ,CAAqBpB,IAArB,CAAlB;GAhCsB;;AClBf,MAAMqB,OAAN,CAAc;EACzB5C,WAAW,CAAC6C,QAAD,EAAWC,SAAX,EAAsB;SACxBD,QAAL,GAAgBA,QAAhB;SACKC,SAAL,GAAiBA,SAAjB;;EAEJC,OAAO,GAAG;UACAC,KAAK,GAAG,KAAKH,QAAL,CAAcG,KAAd,CAAoB,KAApB,CAAd;;WAEOA,KAAK,CAAC3B,MAAN;KACF4B,GAAD,EAAMC,IAAN,EAAYC,CAAZ,KAAkBF,GAAG,GAAGC,IAAN,IAAc,KAAKJ,SAAL,CAAeK,CAAf,KAAqB,EAAnC,CADf;MAAA,CAAP;;;EAKJC,QAAQ,GAAG;WACA,KAAKL,OAAL,EAAP;GAdqB;;ACE7B,MAAMM,KAAK,GAAGC,OAAO,CAACC,QAAR,KAAqB,OAAnC;AACA,MAAMC,WAAW,GAAG,qBAApB;;AAEA,AAAe,MAAMC,OAAN,CAAc;EACzBzD,WAAW,CAAC0D,WAAD,EAAc;UACfC,OAAO,GAAGC,WAAW,CAACP,KAAK,KAAK,IAAV,GAAiBG,WAAjB,GAA+BE,WAAhC,CAA3B;;SAEKG,MAAL,GAAcF,OAAO,CAACE,MAAtB;SACKC,QAAL,GAAgBH,OAAO,CAACG,QAAxB;SACK5B,MAAL,GAAc9B,IAAI,CAAC2D,GAAL,CAAS,GAAG,KAAKF,MAAL,CAAYlD,GAAZ,CAAgBH,KAAK,IAAIA,KAAK,CAAC0B,MAA/B,CAAZ,CAAd;;EAEJa,OAAO,GAAG;UACAiB,eAAe,GAAG5D,IAAI,CAACC,KAAL,CAAW4D,IAAI,CAACC,GAAL,KAAa,KAAKJ,QAA7B,CAAxB;UACMK,YAAY,GAAGH,eAAe,GAAG,KAAKH,MAAL,CAAY3B,MAAnD;;WAEO,KAAK2B,MAAL,CAAYM,YAAZ,CAAP;;EAEJf,QAAQ,GAAG;WACA,KAAKL,OAAL,EAAP;GAfqB;;ACFtB,MAAMqB,iBAAiB,GAAG,CAA1B;AACP,AAAO,MAAMC,cAAc,GAAG,CAAvB;AACP,AAAO,MAAMC,iBAAiB,GAAG,CAA1B;AACP,AAAO,MAAMC,YAAY,GAAG,CAArB;;AAEP,MAAMC,MAAM,GAAG,CAACC,KAAK,CAACC,IAAP,EAAaD,KAAK,CAACE,GAAnB,EAAwBF,KAAK,CAACG,MAA9B,EAAsCH,KAAK,CAACI,KAA5C,CAAf;;AAEA,AAAe,MAAMC,SAAN,CAAgB;EAC3B9E,WAAW,CAAC+E,YAAD,EAAe;SACjBC,KAAL,GAAaD,YAAb;;EAEJhC,OAAO,GAAG;WACCyB,MAAM,CAAC,KAAKQ,KAAN,CAAN,CAAmBC,OAAO,CAACC,GAAR,CAAY,QAAZ,CAAnB,CAAP;;EAEJ9B,QAAQ,GAAG;WACA,KAAKL,OAAL,EAAP;GARuB;;ACV/B;;AAEA,AAAO,MAAMoC,OAAO,GAAG,KAAhB;AACP,AAAO,MAAMC,QAAQ,GAAG,MAAjB;AACP,AAAO,MAAMC,WAAW,GAAG,CAACF,OAAD,EAAUC,QAAV,CAApB;AACP,AAAO,MAAME,gBAAgB,GAAG,QAAzB;AACP,AAAO,MAAMC,sBAAsB,GAAG,cAA/B;AACP,AAAO,MAAMC,gBAAgB,GAAG,QAAzB;AACP,AAAO,MAAMC,iBAAiB,GAAG;AAC7BH,gBAD6B;AAE7BC,sBAF6B;AAG7BC,gBAH6B,CAA1B;;AAKP,AAAO,MAAME,UAAU,GAAG,OAAnB;AACP,AAAO,MAAMC,UAAU,GAAG,OAAnB;AACP,AAAO,MAAMC,UAAU,GAAG,OAAnB;AACP,AAAO,MAAMC,YAAY,GAAG,CAACH,UAAD,EAAaC,UAAb,EAAyBC,UAAzB,CAArB;;ACVP,MAAME,WAAW,GAAG;EAChBC,GAAG,EAAE,KADW;EAEhBC,OAAO,EAAE,SAFO;EAGhBC,IAAI,EAAE,cAHU;EAIhBC,QAAQ,EAAE,UAJM;EAKhBC,QAAQ,EAAE,WALM;EAMhBC,IAAI,EAAE,MANU,EAApB;;AAQA,MAAMC,YAAY,GAAG;EACjBL,OAAO,EAAEM,IAAI,IAAIA,IAAI,CAACzG,IAAL,CAAU,IAAV,CADA,EAArB;;AAGA,MAAM0G,YAAY,GAAG;EACjBC,GAAG,EAAE,MAAM,KADM;EAEjBT,GAAG,EAAEU,MAAM,IAAIA,MAAM,KAAKpB,WAAW,CAAC,CAAD,CAFpB;EAGjBW,OAAO,EAAEM,IAAI,IAAIA,IAAI,CAACpE,MAAL,GAAc,CAHd;EAIjB+D,IAAI,EAAES,GAAG,IAAIA,GAAG,KAAKC,SAJJ;EAKjBT,QAAQ,EAAEU,GAAG,IAAIA,GAAG,KAAKD,SALR;EAMjBR,QAAQ,EAAEM,MAAM,IAAIA,MAAM,KAAKhB,iBAAiB,CAAC,CAAD,CAN/B;EAOjBW,IAAI,EAAEK,MAAM,IAAIA,MAAM,KAAKZ,YAAY,CAAC,CAAD,CAPtB,EAArB;;;AAUA,AAAe,SAASgB,UAAT,CAAoBC,MAApB,EAA4B;SAChCC,MAAM,CAACC,IAAP,CAAYF,MAAZ;EACFzH,MADE,CACK4H,GAAG,IAAI;UACL5H,MAAM,GAAGkH,YAAY,CAACU,GAAD,CAA3B;UACMC,IAAI,GAAGpB,WAAW,CAACmB,GAAD,CAAxB;;;MAGIC,IAAI,KAAKP,SAAT;MACCtH,MAAM,KAAKsH,SAAX,IAAwBtH,MAAM,CAACyH,MAAM,CAACG,GAAD,CAAP,CAAN,KAAwB,IADjD,CADJ;;GALD;EAUFtG,GAVE,CAUEsG,GAAG,IAAI;UACF7D,QAAQ,GAAGiD,YAAY,CAACY,GAAD,CAAZ,IAAqBnH,MAAtC;;WAEQ,GAAEgG,WAAW,CAACmB,GAAD,CAAM,KAAI7D,QAAQ,CAAC0D,MAAM,CAACG,GAAD,CAAP,CAAc,EAArD;GAbD,CAAP;;;ACzBW,SAASE,mBAAT,CAA6BL,MAA7B,EAAqC;QAC1CR,IAAI,GAAGO,UAAU,CAACC,MAAD,CAAvB;QACM9F,KAAK,GAAG,EAAd;;MAEIsF,IAAI,CAACpE,MAAL,GAAc,CAAlB,EAAqB;IACjBlB,KAAK,CAACmB,IAAN;8CAAA;MAAA;OAGOmE,IAAI,CAAC3F,GAAL,CAASyG,IAAI,IAAInC,OAAO,CAACC,GAAR,CAAY,QAAZ,IAAwB,GAAxB,GAA8BkC,IAA/C,CAHP;MAAA;;;;SAQGpG,KAAP;;;AChBW,SAASqG,SAAT,CAAmBC,GAAnB,EAAwB;SAC5BA,GAAG,KAAK,CAAR,GAAY,EAAZ,GAAiB,GAAxB;;;ACDJ;AACA;AAGA,AAAO,MAAMC,wBAAN,SAAuC1F,OAAvC,CAA6C;EAChD7B,WAAW,CAACwH,GAAD,EAAM;UACN,iCAAgCA,GAAI,EAA3C;GAF4C;;;AAMpD,AAAO,MAAMC,0BAAN,SAAyC5F,OAAzC,CAA+C;EAClD7B,WAAW,CAAC0H,UAAD,EAAaC,WAAb,EAA0B;;uBAEVD,UAAW,iCAAgCC,WAAY,EAD9E;;GAF8C;;;AAQtD,AAAO,MAAMC,4BAAN,SAA2C/F,OAA3C,CAAiD;EACpD7B,WAAW,CAAC0H,UAAD,EAAaG,gBAAb,EAA+B;UAC/B,qBAAoBA,gBAAiB,eAAcH,UAAW,EAArE;GAFgD;;;AAMxD,AAAO,MAAMI,2BAAN,SAA0CjG,OAA1C,CAAgD;EACnD7B,WAAW,GAAG;;2FACV;;GAF+C;;ACrBvD,MAAM+H,KAAK,GAAGtD,KAAK,CAACuD,KAAN,CAAYC,IAAZ,CAAiB,SAAjB,CAAd;;AAEA,AAAe,SAASC,WAAT,CAAqBC,GAArB,EAA0B;QAC/BnH,KAAK,GAAG,CAAC,EAAD,CAAd;;UAEQmH,GAAG,CAACnI,WAAZ;SACSuH,wBAAL;MACIvG,KAAK,CAACmB,IAAN;MACI4F,KAAK,GAAG,iDADZ;;;YAIK;;cAECK,KAAK,GAAGD,GAAG,CAACC,KAAJ,CAAUpF,KAAV,CAAgB,IAAhB,CAAd;;QAEAoF,KAAK,CAACC,KAAN;QACArH,KAAK,CAACmB,IAAN,CAAW4F,KAAK,GAAG,GAAR,GAAcI,GAAG,CAACG,OAA7B;QACAtH,KAAK,CAACmB,IAAN,CAAW,GAAGiG,KAAK,CAACzH,GAAN,CAAUjB,IAAI,IAAI+E,KAAK,CAACC,IAAN,CAAWhF,IAAX,CAAlB,CAAd;OAZR;;EAeAsB,KAAK,CAACmB,IAAN,CAAW,EAAX;;EAEAoG,OAAO,CAACC,KAAR,CAAcxH,KAAK,CAACnB,IAAN,CAAW,IAAX,CAAd;EACAyD,OAAO,CAACmF,IAAR,CAAa,CAAb,EArBqC;;;ACLzC,SAASC,UAAT,CAAoBC,YAApB,EAAkC;SACvBvI,IAAI,CAACC,KAAL,CAAWsI,YAAY,GAAG,IAA1B,EAAgCC,OAAhC,CAAwC,CAAxC,IAA6C,GAApD;;;ACoBJ,MAAMjF,OAAO,GAAG,IAAIF,OAAJ,CAAY,MAAZ,CAAhB;;AAEA,SAASoF,YAAT,CAAsBC,UAAtB,EAAkC;SACvB;MACChE,SAAJ,CAAcR,iBAAd,CADG;EAEHG,KAAK,CAACwD,IAAN,CAAWa,UAAU,CAAC5B,IAAtB,CAFG;EAGHzC,KAAK,CAACC,IAAN,CAAW,UAAX,CAHG;EAIHoE,UAAU,CAACC,UAJR;EAKHtE,KAAK,CAACC,IAAN,CAAWO,OAAO,CAAC+D,UAAnB,CALG;EAMHF,UAAU,CAAC3C,QAAX,GAAsB1B,KAAK,CAACC,IAAN,CAAW,KAAX,CANnB;EAOL7E,IAPK,CAOA,GAPA,CAAP;;;AAUJ,SAASoJ,WAAT,CAAqBH,UAArB,EAAiC;SACtB;MACChE,SAAJ,CAAcR,iBAAd,CADG;EAEHG,KAAK,CAACwD,IAAN,CAAWa,UAAU,CAAC5B,IAAtB,CAFG;EAGHzC,KAAK,CAACC,IAAN,CAAW,YAAX,CAHG;EAIL7E,IAJK,CAIA,GAJA,CAAP;;;AAOJ,SAASqJ,YAAT,CAAsBJ,UAAtB,EAAkC;SACvB;MACChE,SAAJ,CAAcT,cAAd,CADG;EAEHI,KAAK,CAACwD,IAAN,CAAWtD,GAAX,CAAemE,UAAU,CAAC5B,IAA1B,CAFG;EAGHzC,KAAK,CAACC,IAAN,CAAW,cAAX,CAHG;EAIHoE,UAAU,CAAC3C,QAJR;EAKH1B,KAAK,CAACC,IAAN,CAAWO,OAAO,CAAC+D,UAAnB,CALG;EAMHF,UAAU,CAACC,UAAX,GAAwBtE,KAAK,CAACC,IAAN,CAAW,KAAX,CANrB;EAOL7E,IAPK,CAOA,GAPA,CAAP;;;AAUJ,SAASsJ,WAAT,CAAqBL,UAArB,EAAiC;SACtB;MACChE,SAAJ,CAAcP,YAAd,CADG;EAEHE,KAAK,CAACwD,IAAN,CAAWa,UAAU,CAAC5B,IAAtB,CAFG;EAGH4B,UAAU,CAAC3C,QAHR;EAIH1B,KAAK,CAACC,IAAN,CAAW,SAAX,CAJG;EAKL7E,IALK,CAKA,GALA,CAAP;;;AAQJ,SAASuJ,QAAT,CAAkBN,UAAlB,EAA8B;SACnB;MACChE,SAAJ,CAAcT,cAAd,CADG;EAEHI,KAAK,CAACwD,IAAN,CAAWtD,GAAX,CAAemE,UAAU,CAAC5B,IAA1B,CAFG;EAGH4B,UAAU,CAAC3C,QAHR;EAIH1B,KAAK,CAACC,IAAN,CAAW,QAAX,CAJG;EAKL7E,IALK,CAKA,GALA,CAAP;;;AAQJ,SAASwJ,YAAT,CAAsBC,QAAtB,EAAgC;SACrB;MACCxE,SAAJ,CAAcV,iBAAd,CADG;EAEHK,KAAK,CAACwD,IAAN,CAAWqB,QAAQ,CAACpC,IAApB,CAFG;EAGHzC,KAAK,CAACC,IAAN,CAAW4E,QAAQ,CAACC,MAApB,CAHG;EAIL1J,IAJK,CAIA,GAJA,CAAP;;;AAOJ,SAAS2J,UAAT,CAAoBC,WAApB,EAAiC/C,GAAjC,EAAsC;QAC5B1F,KAAK,GAAGrB,KAAK,CAACC,OAAN,CAAc6J,WAAd,MAA+B,IAA/B;EACVA,WADU;GAETA,WAAD,CAFJ;;SAIOzI,KAAK,CAAC0I,MAAN,CAAa,CAACjF,KAAK,CAACC,IAAN,CAAY,KAAIgC,GAAI,GAApB,CAAD,EAA0B/C,OAA1B,CAAb,CAAP;;;AAGJ,SAASgG,KAAT,CAAeC,KAAf,EAAsBC,cAAtB,EAAsC;QAC5B5J,QAAQ,GAAG,IAAI0B,QAAJ,CAAakI,cAAc,CAACpI,MAA5B,CAAjB;QACMqI,SAAS,GAAG,IAAI/J,SAAJ,CAAcE,QAAd,CAAlB;QACM8J,SAAS,GAAG9F,IAAI,CAACC,GAAL,EAAlB;MACI8F,eAAJ;;EAEAJ,KAAK,CAAC3H,EAAN,CAAS,OAAT,EAAkB,CAAC,EAAC6E,MAAD,EAAD,KAAc;IAC5B7G,QAAQ,CAACS,MAAT,CAAgByG,mBAAmB,CAACL,MAAD,CAAnC;GADJ;EAGA8C,KAAK,CAAC3H,EAAN,CAAS,sBAAT,EAAiC,CAAC,EAACyE,GAAD,EAAD,KAAW;IACxCoD,SAAS,CAACvJ,OAAV;IACIiJ,UAAU;wCAC8B/E,KAAK,CAACC,IAAN,CAAW,KAAX,CAD9B;IAENgC,GAFM,CADd;;;GADJ;EAQAkD,KAAK,CAAC3H,EAAN,CAAS,cAAT,EAAyB,CAAC,EAACyE,GAAD,EAAD,KAAW;IAChCoD,SAAS,CAACvJ,OAAV;IACIiJ,UAAU,CAAC,iCAAiC/E,KAAK,CAACC,IAAN,CAAW,KAAX,CAAlC,EAAqDgC,GAArD,CADd;;GADJ;EAKAkD,KAAK,CAAC3H,EAAN,CAAS,UAAT,EAAqB,CAAC,EAACgI,WAAD,EAAcX,QAAd,EAAD,KAA6B;IAC9CU,eAAe,GAAGV,QAAlB;IACAQ,SAAS,CAACrJ,IAAV;QACIwJ,WAAW,CAAC/H,MAAZ,KAAuB,CAAvB,IAA4BoH,QAAQ,CAACpH,MAAT,KAAoB,CAApD,EAAuD;MACnDjC,QAAQ,CAACS,MAAT,CAAgB,CAAC,gBAAgB+D,KAAK,CAACwD,IAAN,CAAW,YAAX,CAAjB,CAAhB;KADJ,MAEO,IAAIgC,WAAW,CAAC/H,MAAZ,KAAuB,CAA3B,EAA8B;MACjCjC,QAAQ,CAACS,MAAT,CAAgB;MACZ+D,KAAK,CAACwD,IAAN,CAAW,sBAAX;gDADY,CAAhB;;KADG,MAKA;MACHhI,QAAQ,CAACS,MAAT,CAAgB;UACRkC,OAAJ,CAAY,WAAW6B,KAAK,CAACwD,IAAN,CAAW,aAAX,CAAX,GAAuC,GAAnD,EAAwD;MACpDgC,WAAW,CAAC/H,MADwC;MAEpDmF,SAAS,CAAC4C,WAAW,CAAC/H,MAAb,CAF2C,CAAxD,CADY;;QAAA,CAAhB;;;GAXR;EAoBA0H,KAAK,CAAC3H,EAAN,CAAS,uBAAT,EAAkCiI,KAAK,IAAI;IACvCJ,SAAS,CAACvJ,OAAV;IACIiJ,UAAU,CAACU,KAAK,CAACD,WAAN,CAAkBtJ,GAAlB,CAAsBkI,YAAtB,CAAD,EAAsCqB,KAAK,CAACxD,GAA5C,CADd;;GADJ;EAKAkD,KAAK,CAAC3H,EAAN,CAAS,sBAAT,EAAiCiI,KAAK,IAAI;IACtCJ,SAAS,CAACvJ,OAAV;IACIiJ,UAAU,CAACU,KAAK,CAACD,WAAN,CAAkBtJ,GAAlB,CAAsBsI,WAAtB,CAAD,EAAqCiB,KAAK,CAACxD,GAA3C,CADd;;GADJ;EAKAkD,KAAK,CAAC3H,EAAN,CAAS,uBAAT,EAAkCiI,KAAK,IAAI;IACvCJ,SAAS,CAACvJ,OAAV;IACIiJ,UAAU,CAACU,KAAK,CAACD,WAAN,CAAkBtJ,GAAlB,CAAsBuI,YAAtB,CAAD,EAAsCgB,KAAK,CAACxD,GAA5C,CADd;;GADJ;EAKAkD,KAAK,CAAC3H,EAAN,CAAS,qBAAT,EAAgCiI,KAAK,IAAI;IACrCJ,SAAS,CAACrJ,IAAV;QACIyJ,KAAK,CAAC3K,OAAN,KAAkB,IAAtB,EAA4B;MACxBU,QAAQ,CAACS,MAAT;MACIwJ,KAAK,CAACD,WAAN,CAAkBtJ,GAAlB,CAAsBuJ,KAAK,CAAC3K,OAAN,GAAgB4J,WAAhB,GAA8BC,QAApD,CADJ;;;;;GAHR;EAUAQ,KAAK,CAAC3H,EAAN,CAAS,4BAAT,EAAuCiI,KAAK,IAAI;IAC5CJ,SAAS,CAACvJ,OAAV,CAAkBiJ,UAAU,CAACX,YAAY,CAACqB,KAAD,CAAb,EAAsBA,KAAK,CAACxD,GAA5B,CAA5B;GADJ;EAGAkD,KAAK,CAAC3H,EAAN,CAAS,2BAAT,EAAsCiI,KAAK,IAAI;IAC3CJ,SAAS,CAACvJ,OAAV,CAAkBiJ,UAAU,CAACP,WAAW,CAACiB,KAAD,CAAZ,EAAqBA,KAAK,CAACxD,GAA3B,CAA5B;GADJ;EAGAkD,KAAK,CAAC3H,EAAN,CAAS,4BAAT,EAAuCiI,KAAK,IAAI;IAC5CJ,SAAS,CAACvJ,OAAV,CAAkBiJ,UAAU,CAACN,YAAY,CAACgB,KAAD,CAAb,EAAsBA,KAAK,CAACxD,GAA5B,CAA5B;GADJ;EAGAkD,KAAK,CAAC3H,EAAN,CAAS,0BAAT,EAAqCiI,KAAK,IAAI;IAC1CJ,SAAS,CAACrJ,IAAV;IACAR,QAAQ,CAACS,MAAT,CAAgB,CAAC,CAACwJ,KAAK,CAAC3K,OAAN,GAAgB4J,WAAhB,GAA8BC,QAA/B,EAAyCc,KAAzC,CAAD,CAAhB;QACIL,cAAc,CAACM,UAAf,KAA8B,IAA9B,IAAsCD,KAAK,CAAC3K,OAAN,KAAkB,KAA5D,EAAmE;MAC/DU,QAAQ,CAACS,MAAT,CAAgB,CAACwJ,KAAK,CAACE,MAAP,CAAhB;;GAJR;EAOAR,KAAK,CAAC3H,EAAN,CAAS,KAAT,EAAgB,CAAC,EAAC7C,OAAD,EAAD,KAAe;UACrBiL,QAAQ,GAAG3B,UAAU,CAACzE,IAAI,CAACC,GAAL,KAAa6F,SAAd,CAA3B;UACMO,UAAU,GAAGnL,uBAAuB,CAACC,OAAD,CAA1C;UACMmL,MAAM,GAAG/K,mBAAmB,CAACJ,OAAD,CAAlC;;IAEAa,QAAQ,CAACS,MAAT,CAAgB,CAAC,EAAD,CAAhB;;QAEI4J,UAAU,CAACpI,MAAX,GAAoB,CAAxB,EAA2B;MACvBjC,QAAQ,CAACS,MAAT,CAAgB;UACRkC,OAAJ,CAAY6B,KAAK,CAACwD,IAAN,CAAW,eAAX,IAA8B,YAA1C,EAAwD;MACpDqC,UAAU,CAACpI,MADyC;MAEpDmF,SAAS,CAACiD,UAAU,CAACpI,MAAZ,CAF2C,CAAxD,CADY,CAAhB;;;;QAOAqI,MAAM,CAACrI,MAAP,GAAgB,CAApB,EAAuB;MACnBjC,QAAQ,CAACS,MAAT,CAAgB;UACRkC,OAAJ,CAAY6B,KAAK,CAACwD,IAAN,CAAW,WAAX,IAA0B,YAAtC,EAAoD;MAChDsC,MAAM,CAACrI,MADyC;MAEhDmF,SAAS,CAACkD,MAAM,CAACrI,MAAR,CAFuC,CAApD,CADY,CAAhB;;;;QAOA8H,eAAe,CAAC9H,MAAhB,GAAyB,CAA7B,EAAgC;YACtBoE,IAAI,GAAG0D,eAAe,CAACrJ,GAAhB,CAAoB0I,YAApB,CAAb;;UAEIiB,UAAU,CAACpI,MAAX,GAAoB,CAApB,IAAyBqI,MAAM,CAACrI,MAAP,GAAgB,CAA7C,EAAgD;QAC5CjC,QAAQ,CAACS,MAAT,CAAgB,CAAC,EAAD,CAAhB;;MAEJT,QAAQ,CAACS,MAAT;;UAEYkC,OAAJ,CAAY6B,KAAK,CAACwD,IAAN,CAAW,YAAX,IAA2B,YAAvC,EAAqD;MACjD+B,eAAe,CAAC9H,MADiC;MAEjDmF,SAAS,CAAC2C,eAAe,CAAC9H,MAAjB,CAFwC,CAArD,CADJ;;QAAA;MAMEwH,MANF,CAMSpD,IANT,CADJ;;;;IAWJrG,QAAQ,CAACS,MAAT,CAAgB,CAAC,EAAD,EAAK,IAAIkC,OAAJ,CAAY,oBAAZ,EAAkC,CAACyH,QAAD,CAAlC,CAAL,CAAhB;GAxCJ;EA0CAT,KAAK,CAAC3H,EAAN,CAAS,OAAT,EAAkBkG,GAAG,IAAI,KAAKD,WAAW,CAACC,GAAD,CAAzC;;;ACpNJ,WAAeqC,QAAQ,CAACC,SAAxB;;ACGA;AACA,MAAMC,SAAS,GAAG,EAACf,KAAD,EAAQgB,IAAR,EAAlB;;ACUA,MAAMC,aAAa,GAAG7D,MAAM,CAACC,IAAP,CAAY0D,SAAZ,CAAtB;AACA,MAAMG,cAAc,GAAGC,IAAI,CAACjL,IAAL,CAAUyD,OAAO,CAACkD,GAAR,EAAV,EAAyB,WAAzB,CAAvB;AACA,MAAMuE,UAAU,GAAGC,EAAE,CAACC,UAAH,CAAcJ,cAAd,MAAkC,IAAlC,GAAyCzF,QAAzC,GAAoDD,OAAvE;;AAEA,WAAe+F,KAAK;AACfC,KADU;AAEP;AACI,EADJ;AAEI1G,KAAK,CAACwD,IAAN,CAAWmD,IAAX,CAAgB,6CAAhB,CAFJ;AAGK,GAAE3G,KAAK,CAACwD,IAAN,CAAW,QAAX,CAAqB,OAAMxD,KAAK,CAAC4G,GAAN,CAAU,WAAV,CAAuB,EAHzD;AAIExL,IAJF,CAIOyL,MAJP,CAFO;;AAQV7E,MARU,CAQH,KARG,EAQI;EACX8E,QAAQ,EAAE,oCADC;EAEXC,OAAO,EAAEnG,WAFE;EAGXoG,OAAO,EAAEV,UAHE;EAIXW,KAAK,EAAE,GAJI,EARJ;;AAcVjF,MAdU,CAcH,SAdG,EAcQ;EACf8E,QAAQ,EAAE,iEADK;EAEfI,KAAK,EAAE,IAFQ;EAGfD,KAAK,EAAE,IAHQ,EAdR;;AAmBVjF,MAnBU,CAmBH,WAnBG,EAmBU;EACjB8E,QAAQ,EAAE,2CADO;EAEjBC,OAAO,EAAE/F,iBAFQ;EAGjBgG,OAAO,EAAEhG,iBAAiB,CAAC,CAAD,CAHT;EAIjBiG,KAAK,EAAE,IAJU,EAnBV;;AAyBVjF,MAzBU,CAyBH,MAzBG,EAyBK;EACZ8E,QAAQ,EAAE,kEADE;EAEZC,OAAO,EAAE3F,YAFG;EAGZ4F,OAAO,EAAE5F,YAAY,CAAC,CAAD,CAHT;EAIZ6F,KAAK,EAAE,GAJK,EAzBL;;AA+BVjF,MA/BU,CA+BH,UA/BG,EA+BS;EAChB8E,QAAQ,EAAE,0CADM;EAEhBC,OAAO,EAAEZ,aAFO;EAGhBa,OAAO,EAAEb,aAAa,CAAC,CAAD,CAHN;EAIhBc,KAAK,EAAE,GAJS,EA/BT;;AAqCVjF,MArCU,CAqCH,MArCG,EAqCK;EACZ8E,QAAQ,EAAE,sDADE;EAEZG,KAAK,EAAE,GAFK,EArCL;;AAyCVjF,MAzCU,CAyCH,aAzCG,EAyCY;EACnB8E,QAAQ,EAAE,sCADS;EAEnBK,OAAO,EAAE,IAFU;EAGnBH,OAAO,EAAE,KAHU;EAInBC,KAAK,EAAE,KAJY,EAzCZ;;AA+CVjF,MA/CU,CA+CH,UA/CG,EA+CS;EAChB8E,QAAQ,EAAE,kCADM;EAEhBG,KAAK,EAAE,KAFS,EA/CT;;AAmDVG,OAnDU;AAoDVC,IApDU,CAoDL,IApDK;AAqDVC,IArDU,GAqDHC,IArDZ;;AClBe,MAAMC,QAAN,CAAe;EAC1BjM,WAAW,CAACkH,IAAD,EAAO0C,KAAP,EAAcsC,SAAS,GAAG,EAA1B,EAA8B;SAChChF,IAAL,GAAYA,IAAZ;SACK0C,KAAL,GAAaA,KAAb;SACKsC,SAAL,GAAiBA,SAAjB;SACKC,SAAL,GAAiB,KAAjB;;EAEJC,KAAK,GAAG;SACCD,SAAL,GAAiB,IAAjB;SACKE,IAAL,CAAU,OAAV;;EAEJA,IAAI,CAACC,SAAD,EAAYpC,KAAK,GAAG,EAApB,EAAwB;UAClBqC,aAAa,GAAG,KAAKrF,IAAL,GAAY,GAAZ,GAAkBoF,SAAxC;;QAEI,KAAKH,SAAL,KAAmB,KAAvB,EAA8B;YACpB,IAAItK,KAAJ;2BACmB0K,aAAc,2BADjC,CAAN;;;SAIC3C,KAAL,CAAWyC,IAAX,CAAgBE,aAAhB;SACYL,SADZ;IAEOhC,KAFP;;;EAKJsC,IAAI,CAACC,IAAD,EAAO/F,GAAP,EAAY;SACP2F,IAAL,CAAUI,IAAV,EAAgB,EAAC/F,GAAD,EAAhB;;WAEO,KAAKkD,KAAL,CAAW4C,IAAX,CAAgB9F,GAAhB,CAAP;;EAEJgG,GAAG,CAACpN,MAAD,EAAS;SACH+M,IAAL,CAAU,KAAV,EAAiB/M,MAAjB;SACK6M,SAAL,GAAiB,KAAjB;GA/BsB;;ACM9B,SAASQ,wBAAT,CAAkC,EAACC,OAAD,EAAUC,MAAV,EAAkBC,MAAlB,EAAlC,EAA6D,EAAC3G,QAAD,EAA7D,EAAyE;UAC7DA,QAAR;SACSb,gBAAL;aACWwH,MAAP;SACCtH,gBAAL;aACWqH,MAAP;SACCtH,sBAAL;;aAEW,MAAMqH,OAAb,CAPR;;;;AAWJ,AAAO,SAASG,qBAAT,CAA+BjE,UAA/B,EAA2C;SACvCA,UAAU,CAAC3C,QAAX,KAAwB,MAAM2C,UAAU,CAACC,UAAhD;;;AAGJ,AAAe,SAASiE,gBAAT,CAA0BC,QAA1B,EAAoCC,WAApC,EAAiD;SACrD;IACHhG,IAAI,EAAE+F,QAAQ,CAAC/F,IADZ;IAEHf,QAAQ,EAAEwG,wBAAwB,CAACM,QAAD,EAAWC,WAAX,CAF/B;IAGHnE,UAAU,EAAEkE,QAAQ,CAACL,OAHlB,EAAP;;;;ACvBG,MAAMO,GAAG,GAAG,KAAZ;AACP,AAAO,MAAMC,MAAM,GAAG,QAAf;AACP,AAAO,MAAMC,QAAQ,GAAG,UAAjB;AACP,AAAO,MAAMC,QAAQ,GAAG,UAAjB;AACP,AAAO,MAAMC,UAAU,GAAG,YAAnB;;ACMP,MAAMC,UAAU,GAAG,MAAnB;AACA,MAAMC,WAAW,GAAG;AAChB;EACIvG,IAAI,EAAEoG,QADV;EAEIrH,IAAI,EAAE,CAAC6C,UAAD,EAAa,EAAC9C,OAAD,EAAb;EACFA,OAAO,CAAC0H,IAAR,CAAaxG,IAAI,IAAI4B,UAAU,CAAC5B,IAAX,KAAoBA,IAAzC,MAAmD,IAH3D,EADgB;;AAMhB;EACIA,IAAI,EAAEiG,GADV;EAEIlH,IAAI,EAAE6C,UAAU,IAAIA,UAAU,CAAC3C,QAAX,KAAwB,KAFhD,EANgB;;AAUhB;EACIe,IAAI,EAAEkG,MADV;EAEInH,IAAI,EAAE6C,UAAU,IAAIA,UAAU,CAAC3C,QAAX,KAAwB,QAFhD,EAVgB;;AAchB;EACIe,IAAI,EAAEqG,UADV;EAEItH,IAAI,EAAE6C,UAAU;EACZiE,qBAAqB,CAACjE,UAAD,CAArB,KAAsC,KAAtC;EACA6E,MAAM,CAACC,GAAP,CAAW9E,UAAU,CAAC3C,QAAtB,EAAgC2C,UAAU,CAACC,UAA3C,MAA2D,IAJnE,EAdgB;;AAoBhB;EACI7B,IAAI,EAAEmG,QADV;EAEIpH,IAAI,CAAC6C,UAAD,EAAa;QACTiE,qBAAqB,CAACjE,UAAD,CAArB,KAAsC,IAA1C,EAAgD;aACrC,IAAP;;;UAGE+E,IAAI,GAAGF,MAAM,CAACE,IAAP;IACT/E,UAAU,CAACC,UADF;IAETD,UAAU,CAAC3C,QAFF,CAAb;;UAIM2H,YAAY,GAAGD,IAAI,KAAK,IAAT;IACjBL,UAAU,CAACvH,IAAX,CAAgB4H,IAAhB,MAA0B,IADT;IAEjBA,IAAI,KAAK,YAFb;;WAIOC,YAAY,KAAK,IAAxB;GAfR,EApBgB,CAApB;;;AAuCA,MAAMC,OAAO,GAAGN,WAAW,CAAC9M,GAAZ,CAAgBsF,IAAI,IAAIA,IAAI,CAACiB,IAA7B,CAAhB;;AAEA,AAAe,SAAS8G,gBAAT,CAA0BlF,UAA1B,EAAsCoE,WAAtC,EAAmD;QACxDe,WAAW,GAAGR,WAAW,CAACS,SAAZ;EAChBC,UAAU,IAAIA,UAAU,CAAClI,IAAX,CAAgB6C,UAAhB,EAA4BoE,WAA5B,MAA6C,IAD3C,CAApB;;;SAIOe,WAAW,KAAK,CAAC,CAAjB,GAAqB,IAArB,GAA4BF,OAAO,CAACE,WAAD,CAA1C;;;ACpDJ,SAASG,wBAAT,CAAkCxE,KAAlC,EAAyCyE,WAAzC,EAAsDjE,MAAtD,EAA8D;MACtDA,MAAM,CAAClI,MAAP,KAAkB,CAAtB,EAAyB;;WAEd,EAAP;;;SAGG0H,KAAK,CAAC0E,KAAN;EACFrB,QADE,CACO7C,MADP,EACeiE,WADf;EAEF1N,GAFE,CAEEsM,QAAQ,IAAID,gBAAgB,CAACC,QAAD,EAAWrD,KAAK,CAAC9C,MAAjB,CAF9B,CAAP;;;AAKJ,oEAAgB,WAAoB8C,KAApB,EAA2B;UACjCsC,SAAS,GAAG,EAACpF,MAAM,EAAE8C,KAAK,CAAC9C,MAAf,EAAlB;UACMuH,WAAW,GAAGzE,KAAK,CAAC2E,IAAN,CAAWtB,QAAX,EAApB;UACMuB,QAAQ,GAAG,IAAIvC,QAAJ,CAAa,MAAb,EAAqBrC,KAArB,EAA4BsC,SAA5B,CAAjB;QACI9B,MAAJ;;IAEAoE,QAAQ,CAACpC,KAAT;;QAEI,OAAOxC,KAAK,CAAC6E,oBAAN,EAAP,MAAyC,KAA7C,EAAoD;YAC1C,IAAIlH,wBAAJ,CAA6BqC,KAAK,CAAC9C,MAAN,CAAaN,GAA1C,CAAN;;;UAGEgI,QAAQ,CAAChC,IAAT;qBAAA;IAEF5C,KAAK,CAAC2E,IAAN,CAAWG,cAAX,CAA0B;MACtBxI,QAAQ,EAAE0D,KAAK,CAAC9C,MAAN,CAAaZ,QADD,EAA1B,CAFE,CAAN;;;;QAOI;MACAkE,MAAM,GAAG,OAAOoE,QAAQ,CAAChC,IAAT,CAAc,SAAd,EAAyB6B,WAAzB,CAAP,EAA8CjE,MAAvD;KADJ,CAEE,OAAOjC,GAAP,EAAY;;;;UAINA,GAAG,CAACwG,IAAJ,GAAW,CAAf,EAAkB;cACRxG,GAAN;;;MAGJiC,MAAM,GAAGjC,GAAG,CAACiC,MAAb;;;UAGEwE,cAAc,GAAGR,wBAAwB;IAC3CxE,KAD2C;IAE3CyE,WAF2C;IAG3CjE,MAAM,CAACyE,IAAP,EAH2C,CAA/C;;UAKMC,aAAa,GAAGF,cAAc,CAACjO,GAAf,CAAmBmI,UAAU;IAC/CkF,gBAAgB,CAAClF,UAAD,EAAac,KAAK,CAAC9C,MAAnB,CADE,CAAtB;UAEMxH,MAAM,GAAG;MACX2K,WAAW,EAAE2E,cAAc,CAACvP,MAAf;OACRyJ,UAAD,EAAaiG,KAAb,KAAuBD,aAAa,CAACC,KAAD,CAAb,KAAyB,IADvC,CADF;;MAIXzF,QAAQ,EAAEsF,cAAc,CAACvN,MAAf;OACLiI,QAAD,EAAWR,UAAX,EAAuBiG,KAAvB,KAAiC;cACvBxF,MAAM,GAAGuF,aAAa,CAACC,KAAD,CAA5B;;YAEIxF,MAAM,KAAK,IAAf,EAAqB;iBACVD,QAAP;;;eAGGA,QAAQ,CAACI,MAAT;QACAZ,UADA;UAEHS,MAFG,IAAP;;OARE;QAAA,CAJC,EAAf;;;;IAqBAiF,QAAQ,CAAC9B,GAAT,CAAapN,MAAb;;WAEOA,MAAP;GA9DJ,kBAA+B0P,IAA/B;;AChBe,SAASC,kBAAT,CAA4BnG,UAA5B,EAAwCvJ,OAAxC,EAAiD;SACrD;IACH2H,IAAI,EAAE4B,UAAU,CAAC5B,IADd;IAEHf,QAAQ,EAAE2C,UAAU,CAAC3C,QAFlB;IAGH4C,UAAU,EAAED,UAAU,CAACC,UAHpB;IAIHxJ,OAJG,EAAP;;;;ACDW,SAAS4G,QAAT,CAAkB2C,UAAlB,EAA8B;SAClC;IACH5B,IAAI,EAAE4B,UAAU,CAAC5B,IADd;IAEH2E,OAAO,EAAE/C,UAAU,CAAC3C,QAFjB,EAAP;;;;ACDW,SAAS4C,UAAT,CAAoBD,UAApB,EAAgC;SACpC;IACH5B,IAAI,EAAE4B,UAAU,CAAC5B,IADd;IAEH2E,OAAO,EAAE/C,UAAU,CAACC,UAFjB,EAAP;;;;ACIJ,SAASmG,YAAT,CAAsBtF,KAAtB,EAA6Bd,UAA7B,EAAyC;SAC9Bc,KAAK,CAAC2E,IAAN,CAAWY,OAAX,CAAmB;IACtBjJ,QAAQ,EAAE0D,KAAK,CAAC9C,MAAN,CAAaZ,QADD;IAEtBkJ,OAAO,EAAE,CAACjJ,QAAQ,CAAC2C,UAAD,CAAT,CAFa,EAAnB,CAAP;;;;AAMJ,SAASuG,UAAT,CAAoBzF,KAApB,EAA2B;SAChBA,KAAK,CAAC2E,IAAN,CAAWtI,IAAX,EAAP;;;AAGJ,SAASqJ,cAAT,CAAwB1F,KAAxB,EAA+B2F,gBAA/B,EAAiDC,cAAjD,EAAiE;QACvDJ,OAAO,GAAG,CAACrG,UAAU,CAACwG,gBAAD,CAAX,CAAhB;;MAEIC,cAAc,KAAK7I,SAAvB,EAAkC;IAC9ByI,OAAO,CAACjN,IAAR,CAAagE,QAAQ,CAACqJ,cAAD,CAArB;;;SAGG5F,KAAK,CAAC2E,IAAN,CAAWY,OAAX,CAAmB;IACtBjJ,QAAQ,EAAE0D,KAAK,CAAC9C,MAAN,CAAaZ,QADD;IAEtBkJ,OAFsB,EAAnB,CAAP;;;;AAMWK,8IAAf,WAA6BjB,QAA7B,EAAuCvE,WAAvC,EAAoD9G,CAApD,EAAuDuM,qBAAvD,EAA8E;UACpEC,aAAa,SAASD,qBAA5B;UACME,oBAAoB,GAAGD,aAAa,CAACA,aAAa,CAACzN,MAAd,GAAuB,CAAxB,CAA1C;UACM4G,UAAU,GAAGmB,WAAW,CAAC9G,CAAD,CAA9B;;;UAGM0M,eAAe,GAAGD,oBAAoB,KAAKjJ,SAAzB;QAAA;IAEpBiJ,oBAAoB,CAACrQ,OAArB,KAAiC,IAFrC;;IAIAiP,QAAQ,CAACtC,SAAT;MACIjC,WAAW,EAAE;QACT2C,OAAO,EAAEzJ,CAAC,GAAG,CADJ;QAET2M,KAAK,EAAE7F,WAAW,CAAC/H,MAFV,EADjB;;IAKO4G,UALP;;UAOMc,KAAK,GAAG4E,QAAQ,CAAC5E,KAAvB;QACImG,UAAJ;QACIxQ,OAAJ;;QAEIsQ,eAAe,KAAK,IAAxB,EAA8B;YACpBrB,QAAQ,CAAChC,IAAT,CAAc,UAAd,EAA0B0C,YAAY,CAACtF,KAAD,EAAQd,UAAR,CAAtC,CAAN;;;QAGA;MACAiH,UAAU,SAASvB,QAAQ,CAAChC,IAAT,CAAc,SAAd,EAAyB6C,UAAU,CAACzF,KAAD,CAAnC,CAAnB;MACArK,OAAO,GAAG,IAAV;KAFJ,CAGE,OAAO4I,GAAP,EAAY;;;MAGV4H,UAAU,GAAG5H,GAAb;MACA5I,OAAO,GAAG,KAAV;;;IAGJiP,QAAQ,CAACtC,SAAT,CAAmB3M,OAAnB,GAA6BA,OAA7B;;QAEIA,OAAO,KAAK,KAAhB,EAAuB;YACbiQ,cAAc,GAAGrM,CAAC,GAAG,CAAJ,GAAQ8G,WAAW,CAAC/H,MAApB;MACnB+H,WAAW,CAAC9G,CAAC,GAAG,CAAL,CADQ;MAEnBwD,SAFJ;;YAIM6H,QAAQ,CAAChC,IAAT;gBAAA;MAEF8C,cAAc,CAAC1F,KAAD,EAAQd,UAAR,EAAoB0G,cAApB,CAFZ,CAAN;;;;IAMJhB,QAAQ,CAACnC,IAAT,CAAc,QAAd,EAAwB;MACpBjC,MAAM,EAAE2F,UAAU,CAAC3F,MADC,EAAxB;;;WAIOuF,aAAa,CAACjG,MAAd,CAAqBuF,kBAAkB,CAACnG,UAAD,EAAavJ,OAAb,CAAvC,CAAP;;;AAGJ,4FAAgB;EACZqK,KADY;EAEZK,WAFY;EAGZ2F,oBAHY;;UAKNpB,QAAQ,GAAG,IAAIvC,QAAJ,CAAa,mBAAb,EAAkCrC,KAAlC,EAAyC;MACtDK,WADsD,EAAzC,CAAjB;;;QAIIA,WAAW,CAAC/H,MAAZ,KAAuB,CAA3B,EAA8B;aACnB,EAAP;;;IAGJsM,QAAQ,CAACpC,KAAT;;UAEMuD,aAAa,SAAS1F,WAAW,CAAC5I,MAAZ;KACvBsO,aAAD,EAAgB7G,UAAhB,EAA4B3F,CAA5B;IACIsM,aAAa,CAACjB,QAAD,EAAWvE,WAAX,EAAwB9G,CAAxB,EAA2BwM,aAA3B,CAFO;IAGxBC,oBAAoB,KAAKjJ,SAAzB,GAAqC,EAArC,GAA0C,CAACiJ,oBAAD,CAHlB,CAA5B;;;QAMIA,oBAAoB,KAAKjJ,SAA7B,EAAwC;;MAEpCgJ,aAAa,CAACtH,KAAd;;;IAGJmG,QAAQ,CAACtC,SAAT,GAAqB;MACjByD,aADiB,EAArB;;;IAIAnB,QAAQ,CAAC9B,GAAT;;WAEOiD,aAAP;GAhCJ,kBAA+BK,gBAA/B;;ACjFA,SAASC,UAAT,CAAoBnH,UAApB,EAAgC;SACrBiE,qBAAqB,CAACjE,UAAD,CAArB,KAAsC,KAAtC;EACH6E,MAAM,CAACuC,SAAP,CAAiBpH,UAAU,CAAC3C,QAA5B,EAAsC,MAAM2C,UAAU,CAACC,UAAvD;OADJ;;;AAKJ,AAAe,SAASoH,eAAT,CAAyBlG,WAAzB,EAAsC;QAC3CmG,QAAQ,GAAG,EAAjB;QACMC,WAAW,GAAG,EAApB,CAFiD;;yBAIxBpG,WAAzB,8HAAsC,OAA3BnB,UAA2B;OACjCmH,UAAU,CAACnH,UAAD,CAAV,KAA2B,IAA3B,GAAkCsH,QAAlC,GAA6CC,WAA9C,EAA2DlO,IAA3D;MACI2G,UADJ;;KAL6C;;SAU1C;IACHsH,QADG;IAEHC,WAFG,EAAP;;;;ACfJ,SAASnB,cAAT,CAAsBtF,KAAtB,EAA6Bd,UAA7B,EAAyC;SAC9Bc,KAAK,CAAC2E,IAAN,CAAWY,OAAX,CAAmB;IACtBjJ,QAAQ,EAAE0D,KAAK,CAAC9C,MAAN,CAAaZ,QADD;IAEtBkJ,OAAO,EAAEtG,UAAU,CAACnI,GAAX,CAAewF,QAAf,CAFa,EAAnB,CAAP;;;;AAMJ,SAASkJ,YAAT,CAAoBzF,KAApB,EAA2B;SAChBA,KAAK,CAAC2E,IAAN,CAAWtI,IAAX,EAAP;;;AAGJ,SAASqJ,gBAAT,CAAwB1F,KAAxB,EAA+B0G,iBAA/B,EAAkD;SACvC1G,KAAK,CAAC2E,IAAN,CAAWY,OAAX,CAAmB;IACtBjJ,QAAQ,EAAE0D,KAAK,CAAC9C,MAAN,CAAaZ,QADD;IAEtBkJ,OAAO,EAAEkB,iBAAiB,CAAC3P,GAAlB,CAAsBoI,UAAtB,CAFa,EAAnB,CAAP;;;;AAMWwH,wGAAf,WAAsB/B,QAAtB,EAAgCvE,WAAhC,EAA6C;UACnCL,KAAK,GAAG4E,QAAQ,CAAC5E,KAAvB;QACIrK,OAAJ;QACIwQ,UAAJ;;UAEMvB,QAAQ,CAAChC,IAAT,CAAc,UAAd,EAA0B0C,cAAY,CAACtF,KAAD,EAAQK,WAAR,CAAtC,CAAN;QACI;MACA8F,UAAU,SAASvB,QAAQ,CAAChC,IAAT,CAAc,SAAd,EAAyB6C,YAAU,CAACzF,KAAD,CAAnC,CAAnB;MACArK,OAAO,GAAG,IAAV;KAFJ,CAGE,OAAO4I,GAAP,EAAY;;;MAGV4H,UAAU,GAAG5H,GAAb;MACA5I,OAAO,GAAG,KAAV;;;IAGJiP,QAAQ,CAACtC,SAAT,CAAmB3M,OAAnB,GAA6BA,OAA7B;;QAEIA,OAAO,KAAK,KAAZ,IAAqB0K,WAAW,CAAC/H,MAAZ,GAAqB,CAA9C,EAAiD;;;YAGvCsM,QAAQ,CAAChC,IAAT;gBAAA;MAEF8C,gBAAc,CAAC1F,KAAD,EAAQK,WAAW,CAACuG,KAAZ,CAAkB,CAAlB,CAAR,CAFZ,CAAN;;;;IAMJhC,QAAQ,CAACnC,IAAT,CAAc,QAAd,EAAwB;MACpBjC,MAAM,EAAE2F,UAAU,CAAC3F,MADC,EAAxB;;;WAIO7K,OAAP;;;AAGJ,kFAAgB,WAA2BqK,KAA3B,EAAkCK,WAAlC,EAA+C;UACrDuE,QAAQ,GAAG,IAAIvC,QAAJ,CAAa,cAAb,EAA6BrC,KAA7B,EAAoC;MACjDK,WADiD,EAApC,CAAjB;;QAGI1K,OAAO,GAAG,IAAd;;QAEI0K,WAAW,CAAC/H,MAAZ,GAAqB,CAAzB,EAA4B;MACxBsM,QAAQ,CAACpC,KAAT;MACA7M,OAAO,SAASgR,MAAM,CAAC/B,QAAD,EAAWvE,WAAX,CAAtB;MACAuE,QAAQ,CAACtC,SAAT,GAAqB;QACjB3M,OADiB,EAArB;;MAGAiP,QAAQ,CAAC9B,GAAT;;;WAGGnN,OAAP;GAfJ,kBAA+BkR,WAA/B;;ACrDA,SAASC,kBAAT,CAA4BpR,MAA5B,EAAoC;SACzBA,MAAM,CAACC,OAAP,KAAmB,IAAnB,IAA2BwN,qBAAqB,CAACzN,MAAD,CAArB,KAAkC,IAApE;;;AAGWqR,qJAAf,WAAgCnC,QAAhC,EAA0CoC,UAA1C,EAAsDC,UAAtD,EAAkE;UACxDjH,KAAK,GAAG4E,QAAQ,CAAC5E,KAAvB;UACMkH,cAAc,GAAGF,UAAU,CAACjQ,GAAX,CAAerB,MAAM,IAAIA,MAAM,CAAC4H,IAAhC,CAAvB;UACM6J,OAAO,GAAGnH,KAAK,CAAC2E,IAAN,CAAWjI,IAAX,CAAgB,EAAC8I,OAAO,EAAE0B,cAAV,EAAhB,CAAhB;QACI1G,MAAJ;;QAEI;MACAA,MAAM,GAAG,OAAOoE,QAAQ,CAAChC,IAAT,CAAc,iBAAd,EAAiCuE,OAAjC,CAAP,EAAkD3G,MAA3D;KADJ,CAEE,OAAOjC,GAAP,EAAY;;UAENA,GAAG,CAACwG,IAAJ,GAAW,CAAf,EAAkB;cACRxG,GAAN;;MAEJiC,MAAM,GAAGjC,GAAG,CAACiC,MAAb;;UAEE4G,cAAc,GAAGpH,KAAK,CAAC0E,KAAN,CAAYhI,IAAZ,CAAiB8D,MAAjB,EAAyB2G,OAAzB,CAAvB;;;MAGIF,UAAU;MACLlQ,GADL,CACSrB,MAAM,IAAI;YACPoR,kBAAkB,CAACpR,MAAD,CAAlB,KAA+B,KAAnC,EAA0C;iBAC/BA,MAAP;;;cAGEuM,OAAO,GAAGmF,cAAc,CAACC,IAAf;QACZC,MAAM,IAAIA,MAAM,CAAChK,IAAP,KAAgB5H,MAAM,CAAC4H,IADrB;QAEd2E,OAFF;;;QAKOvM,MADP;UAEI6G,QAAQ,EAAE0F,OAFd;;OAVR;;;;OAkBKxM,MAlBL,CAkBYC,MAAM,IAAIA,MAAM,CAACyJ,UAAP,KAAsBzJ,MAAM,CAAC6G,QAlBnD,CADJ;;;;AAuBJ,wEAAgB,WAAsByD,KAAtB,EAA6BxK,OAA7B,EAAsC;UAC5CwR,UAAU,GAAGxR,OAAO,CAACC,MAAR,CAAeqR,kBAAf,CAAnB;UACMlC,QAAQ,GAAG,IAAIvC,QAAJ,CAAa,QAAb,EAAuBrC,KAAvB,CAAjB;QACIuH,eAAe,GAAG/R,OAAtB;;QAEIwR,UAAU,CAAC1O,MAAX,GAAoB,CAAxB,EAA2B;MACvBsM,QAAQ,CAACpC,KAAT;MACAoC,QAAQ,CAACnC,IAAT,CAAc,YAAd,EAA4B,EAACuE,UAAD,EAA5B;MACAO,eAAe,SAASR,gBAAgB,CAACnC,QAAD,EAAWoC,UAAX,EAAuBxR,OAAvB,CAAxC;MACAoP,QAAQ,CAAC9B,GAAT,CAAa,EAACtN,OAAO,EAAE+R,eAAV,EAAb;;;WAGGA,eAAP;GAZJ,kBAA+BC,MAA/B;;AC7CA;AACA,MAAMC,qBAAqB,GAAG,gEAA9B;AACA,MAAMC,aAAa,GAAG,OAAtB;;AAEA,SAAShD,KAAT,CAAeiD,YAAf,EAA6B;QACnBC,KAAK,GAAGD,YAAY,CAACC,KAAb,CAAmBH,qBAAnB,CAAd;;SAEOG,KAAK,KAAK,IAAV;MAAA;;IAGCC,QAAQ,EAAED,KAAK,CAAC,CAAD,CADnB;IAEIE,KAAK,EAAEF,KAAK,CAAC,CAAD,CAFhB;IAGIG,KAAK,EAAEH,KAAK,CAAC,CAAD,CAHhB;IAIII,KAAK,EAAEJ,KAAK,CAAC,CAAD,CAJhB;IAKIK,OAAO,EAAEL,KAAK,CAAC,CAAD,CALlB,EAFJ;;;;AAWJ,SAASM,QAAT,CAAkB,EAACL,QAAD,EAAWC,KAAX,EAAkBC,KAAlB,EAAyBC,KAAzB,EAAlB,EAAmD;SACxCH,QAAQ,KAAK,EAAb;GACFC,KAAD,EAAQC,KAAR,EAAeC,KAAf,EAAsBG,KAAtB;EACIlG,OAAO,IAAIyF,aAAa,CAACrL,IAAd,CAAmB4F,OAAnB,MAAgC,IAD/C,CADJ;;;;AAMJ,SAASmG,qBAAT,CAA+BC,cAA/B,EAA+CC,gBAA/C,EAAiE;EACtDP,KADsD,GAC5BM,cAD4B,CACtDN,KADsD,CAC/CC,KAD+C,GAC5BK,cAD4B,CAC/CL,KAD+C,CACxCH,QADwC,GAC5BQ,cAD4B,CACxCR,QADwC;MAEzDU,QAAQ,GAAGD,gBAAgB,CAACP,KAAhC;MACIS,QAAQ,GAAGF,gBAAgB,CAACN,KAAhC;;MAEIN,aAAa,CAACrL,IAAd,CAAmB0L,KAAnB,MAA8B,KAAlC,EAAyC;IACrCQ,QAAQ,GAAGR,KAAX;IACAS,QAAQ,GAAGd,aAAa,CAACrL,IAAd,CAAmB2L,KAAnB,MAA8B,IAA9B,GAAqCD,KAArC,GAA6CC,KAAxD;GAFJ,MAGO,IAAIN,aAAa,CAACrL,IAAd,CAAmB2L,KAAnB,MAA8B,KAAlC,EAAyC;IAC5CQ,QAAQ,GAAGR,KAAX;;;SAGGH,QAAQ;EACXS,gBAAgB,CAACR,KADd;KAAA;EAGHS,QAHG;KAAA;EAKHC,QALG;EAMHF,gBAAgB,CAACL,OANrB;;;AASJ,SAASQ,oBAAT,CAA8BH,gBAA9B,EAAgD;SACrCA,gBAAgB,KAAK,IAArB,IAA6BA,gBAAgB,CAACT,QAAjB,KAA8B,EAAlE;;;AAGJ,SAASa,aAAT,CAAuBC,UAAvB,EAAmC;SACxB,MAAMA,UAAb;;;;;;;;;;;;;AAaJ,AAAe,SAASC,kBAAT,CAA4BC,QAA5B,EAAsCF,UAAtC,EAAkD;QACvDN,cAAc,GAAG3D,KAAK,CAACmE,QAAQ,CAAC5D,IAAT,EAAD,CAA5B;;MAEIoD,cAAc,KAAK,IAAvB,EAA6B;QACrBH,QAAQ,CAACG,cAAD,CAAR,KAA6B,IAAjC,EAAuC;;aAE5BM,UAAP;;;UAGEL,gBAAgB,GAAG5D,KAAK,CAACiE,UAAD,CAA9B;;QAEIF,oBAAoB,CAACH,gBAAD,CAApB,KAA2C,KAA/C,EAAsD;aAC3CK,UAAP;;;UAGEG,eAAe,GAAGV,qBAAqB;IACzCC,cADyC;IAEzCC,gBAFyC,CAA7C;;;;QAMIvE,MAAM,CAACuC,SAAP,CAAiBqC,UAAjB,EAA6BG,eAA7B,MAAkD,IAAtD,EAA4D;aACjDA,eAAP;;;;SAIDJ,aAAa,CAACC,UAAD,CAApB;;;ACxFJ,MAAMI,eAAe,GAAG;AACpB,cADoB;AAEpB,iBAFoB;AAGpB,sBAHoB,CAAxB;;;AAMA,SAASD,eAAT,CAAyBxF,WAAzB,EAAsC0F,eAAtC,EAAuDrC,MAAvD,EAA+D;UACnDrD,WAAW,CAAC9G,IAApB;SACST,UAAL;aACW,MAAM4K,MAAM,CAACpK,QAApB;SACCP,UAAL;aACW2K,MAAM,CAACpK,QAAd;SACCT,UAAL,CALJ;;;SAQO8M,kBAAkB,CAACI,eAAD,EAAkBrC,MAAM,CAACpK,QAAzB,CAAzB;;;AAGJ,AAAe,SAAS0M,wBAAT;AACXC,cADW;AAEXnD,aAFW;AAGXzC,WAHW;AAIb;QACQ6F,cAAc,qBAAOD,cAAP,CAApB;QACME,iBAAiB,GAAG7T,uBAAuB,CAACwQ,aAAD,CAAjD;MACIsD,kBAAkB,GAAGD,iBAAzB;;EAEAL,eAAe;EACVtT,MADL,CACY6T,IAAI,IAAIJ,cAAc,CAACI,IAAD,CAAd,KAAyBvM,SAD7C;EAEKwM,OAFL,CAEaD,IAAI,IAAI;UACPE,YAAY,GAAGN,cAAc,CAACI,IAAD,CAAnC;UACMG,eAAe,GAAG,EAAxB;;IAEAtM,MAAM,CAACC,IAAP,CAAYoM,YAAZ,EAA0BD,OAA1B,CAAkCG,UAAU,IAAI;YACtC/C,MAAM,GAAGyC,iBAAiB,CAAC/B,IAAlB;OACV,EAAC/J,IAAD,EAAD,KAAYA,IAAI,KAAKoM,UADV,CAAf;;YAGMV,eAAe,GAAGQ,YAAY,CAACE,UAAD,CAApC;;MAEAD,eAAe,CAACC,UAAD,CAAf,GAA8B/C,MAAM,KAAK5J,SAAX;MAC1BiM,eAD0B;MAE1BF,eAAe,CAACxF,WAAD,EAAc0F,eAAd,EAA+BrC,MAA/B,CAFnB;;MAIA0C,kBAAkB,GAAGA,kBAAkB,CAAC5T,MAAnB;OAChB,EAAC6H,IAAD,EAAD,KAAYA,IAAI,KAAKoM,UADJ,CAArB;;KAVJ;;IAeAP,cAAc,CAACG,IAAD,CAAd,GAAuBG,eAAvB;GArBR;;MAwBIJ,kBAAkB,CAAC/Q,MAAnB,GAA4B,CAAhC,EAAmC;UACzBkR,YAAY,GAAGL,cAAc,CAACK,YAAf,IAA+B,EAApD;;IAEAH,kBAAkB,CAACE,OAAnB,CAA2B5C,MAAM,IAAI;MACjC6C,YAAY,CAAC7C,MAAM,CAACrJ,IAAR,CAAZ,GAA4BqJ,MAAM,CAACpK,QAAnC;KADJ;;IAIA4M,cAAc,CAACK,YAAf,GAA8BA,YAA9B;;;SAGGL,cAAP;;;AC9DJ,SAASQ,QAAT,CAAkBtQ,GAAlB,EAAuB;SACZA,GAAG,CAACuQ,MAAJ,CAAWvQ,GAAG,CAACf,MAAJ,GAAa,CAAxB,CAAP;;;AAGJ,SAASuR,SAAT,CAAmBV,cAAnB,EAAmCW,iBAAnC,EAAsD;MAC9CC,iBAAiB,GAAGC,IAAI,CAACH,SAAL,CAAeV,cAAf,EAA+B,IAA/B,EAAqC,IAArC,CAAxB;QACMc,0BAA0B,GAAGN,QAAQ,CAACG,iBAAD,CAA3C;;;MAGIG,0BAA0B,KAAKN,QAAQ,CAACI,iBAAD,CAA3C,EAAgE;IAC5DA,iBAAiB,IAAIE,0BAArB;;;SAGGF,iBAAP;;;AAGWG,4JAAf,WAAmCC,EAAnC,EAAuCC,eAAvC,EAAwD;QAChD;mBACaD,EAAE,EAAf;KADJ,CAEE,OAAO5L,GAAP,EAAY;MACVA,GAAG,CAACG,OAAJ,GAAc0L,eAAe,GAAG7L,GAAG,CAACG,OAApC;YACMH,GAAN;;;;AAIR,8FAAgB,WAAiCyB,KAAjC,EAAwC+F,aAAxC,EAAuD;UAC7DnB,QAAQ,GAAG,IAAIvC,QAAJ,CAAa,qBAAb,EAAoCrC,KAApC,CAAjB;QACI8J,iBAAJ;;IAEAlF,QAAQ,CAACpC,KAAT;;UAEM0G,cAAc,SAASgB,mBAAmB;iBAChC;MACRJ,iBAAiB,SAAS9J,KAAK,CAACqK,QAAN,CAAe,cAAf,CAA1B;;aAEOL,IAAI,CAACtF,KAAL,CAAWoF,iBAAX,CAAP;KAJwC;mDAAA,CAAhD;;UAQMX,cAAc,GAAGF,wBAAwB;IAC3CC,cAD2C;IAE3CnD,aAF2C;IAG3C/F,KAAK,CAAC9C,MAHqC,CAA/C;;;UAMMgN,mBAAmB;;IAEjBlK,KAAK,CAACsK,SAAN;kBAAA;IAEIT,SAAS,CAACV,cAAD,EAAiBW,iBAAjB,CAFb,CAFiB;;oDAAA,CAAzB;;;IASAlF,QAAQ,CAAC9B,GAAT,CAAa;MACTyH,WAAW,EAAEpB,cADJ,EAAb;;GA7BJ,kBAA+BqB,iBAA/B;;;;ACpBeC,wIAAf,WAA8BzK,KAA9B,EAAqCK,WAArC,EAAkD;UACxC7K,OAAO,GAAG,EAAhB,CAD8C;IAEdkV,eAAgB,CAACrK,WAAD,CAFF,CAEvCmG,QAFuC,qBAEvCA,QAFuC,CAE7BC,WAF6B,qBAE7BA,WAF6B;UAGxCkE,qBAAqB,GAAGnE,QAAQ,CAACI,KAAT,EAA9B;QACIgE,YAAJ,CAJ8C;QAK1CC,kBAAJ;;;;;QAKIpE,WAAW,CAACnO,MAAZ,GAAqB,CAAzB,EAA4B;MACxBsS,YAAY,SAAS/D,WAAW,CAAC7G,KAAD,EAAQyG,WAAR,CAAhC;;;QAGAmE,YAAY,KAAK,IAArB,EAA2B;MACvBpV,OAAO,CAAC+C,IAAR;SACOkO,WAAW,CAAC1P,GAAZ,CAAgBmI,UAAU;MACzBmG,kBAAkB,CAACnG,UAAD,EAAa,IAAb,CADnB,CADP;;;KADJ,MAMO;MACHyL,qBAAqB,CAACG,OAAtB,CAA8B,GAAGrE,WAAjC;;UAEImE,YAAY,KAAK,KAArB,EAA4B;QACxBC,kBAAkB,GAAGxF,kBAAkB,CAACoB,WAAW,CAAC,CAAD,CAAZ,EAAiB,KAAjB,CAAvC;;;;;IAKRjR,OAAO,CAAC+C,IAAR;cACc6N,gBAAgB;IACtBpG,KADsB;IAEtB2K,qBAFsB;IAGtBE,kBAHsB,CAA1B,CADJ;;;;WAQOrD,MAAM,CAACxH,KAAD,EAAQxK,OAAR,CAAb;;;AAGJ,kEAAgB,WAAmBwK,KAAnB,EAA0B;UAChCxK,OAAO,GAAG,EAAhB;;IAEAwK,KAAK,CAACyC,IAAN,CAAW,OAAX,EAAoB;MAChBvF,MAAM,EAAE8C,KAAK,CAAC9C,MADE,EAApB,EAHsC;;;MAOVkI,IAAI,CAACpF,KAAD,CAPM,EAO/BK,WAP+B,QAO/BA,WAP+B;;QASlCA,WAAW,CAAC/H,MAAZ,GAAqB,CAAzB,EAA4B;MACxB9C,OAAO,CAAC+C,IAAR,CAAa,UAAUkS,cAAc,CAACzK,KAAD,EAAQK,WAAR,CAAxB,CAAb;YACMmK,iBAAiB,CAACxK,KAAD,EAAQxK,OAAR,CAAvB;;;IAGJwK,KAAK,CAACyC,IAAN,CAAW,KAAX,EAAkB;MACdvF,MAAM,EAAE8C,KAAK,CAAC9C,MADA;MAEd1H,OAFc,EAAlB;;;WAKOA,OAAP;GAnBJ,kBAA+BuV,GAA/B;;AC7CA,WAAeC,IAAI,CAAC5J,EAAD,CAAnB;;ACDA,SAAS6J,WAAT,CAAqBrO,GAArB,EAA0BE,GAA1B,EAA+B;SACpB,IAAIoO,OAAJ,CAAYC,OAAO,IAAI;IAC1BC,YAAY,CAACxI,IAAb;IACI9F,GADJ;MAEKuO,SAAS,EAAEC,QAAZ,EAAsBC,QAAQ,EAAE,MAAhC,EAAwC3O,GAAxC,EAFJ;;KAIK2B,GAAD,EAAMiC,MAAN,EAAcgL,MAAd,KAAyB,KAAKL,OAAO,CAAC,EAAC5M,GAAD,EAAMiC,MAAN,EAAcgL,MAAd,EAAD,CAJzC;;GADG,CAAP;;;AAUJ,oEAAgB,WAAoB5O,GAApB,EAAyBE,GAAzB,EAA8B;MACNmO,WAAW,CAACrO,GAAD,EAAME,GAAN,CADL,EACnCyB,GADmC,QACnCA,GADmC,CAC9BiC,MAD8B,QAC9BA,MAD8B,CACtBgL,MADsB,QACtBA,MADsB;;QAGtCjN,GAAG,KAAK,IAAZ,EAAkB;MACdA,GAAG,CAACiC,MAAJ,GAAaA,MAAb;MACAjC,GAAG,CAACiN,MAAJ,GAAaA,MAAb;;YAEMjN,GAAN;;;WAGG,EAACiC,MAAD,EAASgL,MAAT,EAAP;GAVJ,kBAA+B5I,IAA/B;;ACbA,SAAS6I,SAAT,CAAmBC,OAAnB,EAA4B;SACjB,CAAC,EAACpP,QAAD,EAAWkJ,OAAX,KAAsB,EAAvB;GACFkG,OAAD,EAAUC,iBAAiB,CAACrP,QAAD,CAA3B,EAAuCsP,gBAAgB,CAACpG,OAAD,CAAvD,EAAkEvP,IAAlE;IAAA,CADJ;;;;AAMJ,SAAS2V,gBAAT,CAA0BpG,OAA1B,EAAmC;SACxBzP,KAAK,CAACC,OAAN,CAAcwP,OAAd,MAA2B,IAA3B;;EAEGA;;;GAGKzO,GAHL,CAGS,CAAC,EAACuG,IAAD,EAAO2E,OAAP,EAAD,KAAsB,IAAG3E,IAAK,IAAG2E,OAAQ,GAHlD;EAIKhM,IAJL,CAIU,GAJV,CAFH;IAAP;;;AAUJ,SAAS0V,iBAAT,CAA2BrP,QAA3B,EAAqC;SAC1BA,QAAQ,KAAKS,SAAb,GAAyB,EAAzB,GAA+B,gBAAeT,QAAS,GAA9D;;;AAGJ,MAAMqI,IAAI,GAAG;EACTkH,GAAG,EAAE;IACDxI,QAAQ,EAAE,MAAM,+BADf;IAEDyB,cAAc,EAAE2G,SAAS,CAAC,aAAD,CAFxB;IAGDlG,OAAO,EAAEkG,SAAS,CAAC,aAAD,CAHjB;;IAKDpP,IAAI,EAAE,MAAM,UALX;IAMDK,IAAI,EAAE,CAAC,EAAC8I,OAAD,KAAY,EAAb,KAAoB;6BAAA;IAEtBzP,KAAK,CAACC,OAAN,CAAcwP,OAAd,MAA2B,IAA3B,GAAkC,MAAMA,OAAO,CAACvP,IAAR,CAAa,GAAb,CAAxC,GAA4D,EAFtC;IAGxBA,IAHwB,CAGnB,EAHmB,CANzB,EADI;;;;EAcT6V,IAAI,EAAE;IACFzI,QAAQ,EAAE,MAAM,6BADd;IAEFyB,cAAc,EAAE2G,SAAS,CAAC,MAAD,CAFvB;IAGFlG,OAAO,EAAEkG,SAAS,CAAC,UAAD,CAHhB;;IAKFpP,IAAI,EAAE,MAAM,WALV;IAMFK,IAAI,EAAE,CAAC,EAAC8I,OAAD,KAAY,EAAb,KAAoB;gCAAA;IAEtBzP,KAAK,CAACC,OAAN,CAAcwP,OAAd,MAA2B,IAA3B,GAAkC,MAAMA,OAAO,CAACvP,IAAR,CAAa,GAAb,CAAxC,GAA4D,EAFtC;IAGxBA,IAHwB,CAGnB,EAHmB,CANxB,EAdG,EAAb;;ACpBA,MAAM8V,iBAAiB,GAAG,CAAC,MAAD,EAAS,SAAT,EAAoB,QAApB,EAA8B,QAA9B,CAA1B;;AAEA,SAASC,gBAAT,CAA0BC,KAA1B,EAAiC;SACtB,OAAOA,KAAP,KAAiB,QAAjB,IAA6BA,KAAK,CAAC3T,MAAN,GAAe,CAAnD;;;AAGJ,SAAS4T,aAAT,CAAuBxW,MAAvB,EAA+B;EAC3BqW,iBAAiB,CAACxC,OAAlB,CAA0B4C,IAAI,IAAI;QAC1BH,gBAAgB,CAACtW,MAAM,CAACyW,IAAD,CAAP,CAAhB,KAAmC,KAAvC,EAA8C;YACpC,IAAIlU,KAAJ,CAAU,6CAAV,CAAN;;GAFR;;SAMOvC,MAAP;;;AAGJ,SAAS0W,QAAT,CAAkBC,MAAlB,EAA0B;SACf,CAAC7L,MAAD,EAAS1D,GAAT,KAAiB;QAChB;aACOuP,MAAM,CAAC7L,MAAD,CAAb;KADJ,CAEE,OAAOjC,GAAP,EAAY;MACVA,GAAG,CAACG,OAAJ,GAAe,mDAAkD5B,GAAI,MAAKyB,GAAG,CAACG,OAAQ,EAAtF;YACMH,GAAN;;GALR;;;AAUJ,SAAS+N,QAAT,CAAkBC,GAAlB,EAAuBnP,IAAvB,EAA6B;SAClBA,IAAI,CAAC3F,MAAL,CAAY,CAAC+U,GAAD,EAAMnP,GAAN,EAAW9D,CAAX,KAAiB;IAChCiT,GAAG,CAACnP,GAAD,CAAH,GAAWkP,GAAG,CAAChT,CAAD,CAAd;;WAEOiT,GAAP;GAHG,EAIJ,EAJI,CAAP;;;;;;;AAWJ,SAASC,UAAT,CAAoBC,EAApB,EAAwBC,EAAxB,EAA4B;SACjBD,EAAE,CAACpP,IAAH,GAAUqP,EAAE,CAACrP,IAApB;;;AAGJ,SAASsP,SAAT,CAAmBpM,MAAnB,EAA2B;QACjBqM,OAAO,GAAGrM,MAAM,CAACyE,IAAP,EAAhB;;MAEI4H,OAAO,CAACvU,MAAR,KAAmB,CAAvB,EAA0B;WACf,IAAP;;;SAGG0R,IAAI,CAACtF,KAAL,CAAWmI,OAAX,CAAP;;;AAGJ,SAASC,UAAT,CAAoBtM,MAApB,EAA4BuM,kBAA5B,EAAgD;MACxC;WACOH,SAAS,CAACpM,MAAD,CAAhB;GADJ,CAEE,OAAO5B,KAAP,EAAc;;;;QAIVoO,QAAQ,GAAGxM,MAAM;EAClBpH,KADY,CACNsI,MADM;EAEZ3K,GAFY,CAERjB,IAAI,IAAIA,IAAI,CAACmP,IAAL,EAFA;EAGZxP,MAHY,CAGLK,IAAI,IAAIA,IAAI,KAAK,EAHZ;EAIZuR,IAJY,CAIPvR,IAAI,IAAI;QACN;YACMmX,UAAU,GAAGjD,IAAI,CAACtF,KAAL,CAAW5O,IAAX,CAAnB;;aAEOmX,UAAU,CAAC3D,IAAX,KAAoByD,kBAA3B;KAHJ,CAIE,OAAOnO,KAAP,EAAc;aACL,KAAP;;GAVK,CAAjB;;MAcIoO,QAAQ,KAAKjQ,SAAjB,EAA4B;UAClB,IAAI9E,KAAJ,CAAW,uCAAsC8U,kBAAmB,EAApE,CAAN;;;SAGG/C,IAAI,CAACtF,KAAL,CAAWsI,QAAX,CAAP;;;AAGJ,MAAMtI,OAAK,GAAG;EACVmH,GAAG,EAAE;IACDxI,QAAQ,EAAE+I,QAAQ,CAAC5L,MAAM,IAAI;YACnB0M,MAAM,GAAGN,SAAS,CAACpM,MAAD,CAAxB;;UAEI0M,MAAM,KAAK,IAAf,EAAqB;eACV,EAAP;;;YAGEC,KAAK,GAAGhQ,MAAM,CAACC,IAAP,CAAY8P,MAAZ,CAAd;;aAEOC,KAAK;MACPpW,GADE,CACEuG,IAAI,IAAI4P,MAAM,CAAC5P,IAAD,CADhB;MAEFvG,GAFE,CAEE,CAACqW,GAAD,EAAMjI,KAAN;MACD+G,aAAa,CAAC;QACV5O,IAAI,EAAE6P,KAAK,CAAChI,KAAD,CADD;QAEVnC,OAAO,EAAEoK,GAAG,CAACpK,OAFH;QAGVC,MAAM,EAAEmK,GAAG,CAACnK,MAHF;QAIVC,MAAM,EAAEkK,GAAG,CAAClK,MAJF,EAAD,CAHd;;;MAUFmK,IAVE,CAUGZ,UAVH,CAAP;KATc,CADjB;IAsBD/P,IAAI,EAAE0P,QAAQ,CAAC5L,MAAM,IAAI;YACf0M,MAAM,GAAGN,SAAS,CAACpM,MAAD,CAAxB;;aAEQ0M,MAAM,CAAC1D,YAAP,KAAwBzM,SAAxB;QAAA;MAEJI,MAAM,CAACC,IAAP,CAAY8P,MAAM,CAAC1D,YAAnB;MACKzS,GADL,CACSuG,IAAI,KAAK;QACVA,IADU;QAEV2E,OAAO,EAAEiL,MAAM,CAAC1D,YAAP,CAAoBlM,IAApB,EAA0B2E,OAFzB,EAAL,CADb;;MAKKoL,IALL,CAKUZ,UALV,CAFJ;KAHU,CAtBb,EADK;;EAoCVX,IAAI,EAAE;IACFzI,QAAQ,EAAE+I,QAAQ;IACd5L,MAAM,IAAI;YACA0M,MAAM,GAAGJ,UAAU,CAACtM,MAAD,EAAS,OAAT,CAAzB;;UAEI0M,MAAM,KAAK,IAAf,EAAqB;eACV,EAAP;;;aAGGA,MAAM,CAACI,IAAP,CAAYC,IAAZ;MACFxW,GADE,CACEyW,GAAG,IAAIlB,QAAQ,CAACkB,GAAD,EAAMN,MAAM,CAACI,IAAP,CAAYG,IAAlB,CADjB;MAEF1W,GAFE,CAEEqW,GAAG;MACJlB,aAAa,CAAC;QACV5O,IAAI,EAAE8P,GAAG,CAACM,OADA;QAEV1K,OAAO,EAAEoK,GAAG,CAACO,OAFH;QAGV1K,MAAM,EAAEmK,GAAG,CAACQ,MAHF;QAIV1K,MAAM,EAAEkK,GAAG,CAACS,MAJF,EAAD,CAHd;;;MAUFR,IAVE,CAUGZ,UAVH,CAAP;KARU,CADhB;;IAsBF/P,IAAI,EAAE0P,QAAQ,CAAC5L,MAAM,IAAI;YACf0M,MAAM,GAAGJ,UAAU,CAACtM,MAAD,EAAS,MAAT,CAAzB;;UAEI0M,MAAM,CAACI,IAAP,CAAYQ,KAAZ,CAAkBxV,MAAlB,KAA6B,CAAjC,EAAoC;eACzB,EAAP;;;aAGG4U,MAAM,CAACI,IAAP,CAAYQ,KAAZ;MACF/W,GADE,CACEgX,UAAU,IAAI;QACSA,UAAU,CAACzQ,IAAX,CAAgBlE,KAAhB,CAAsB,GAAtB,CADT,mEACRkE,IADQ,6BACF2E,OADE;;YAGX+J,gBAAgB,CAAC1O,IAAD,CAAhB,KAA2B,KAA3B,IAAoC0O,gBAAgB,CAAC/J,OAAD,CAAhB,KAA8B,KAAtE,EAA6E;gBACnE,IAAIhK,KAAJ,CAAW,oCAAmC8V,UAAU,CAACzQ,IAAK,GAA9D,CAAN;;;eAGG;UACHA,IADG;UAEH2E,OAFG,EAAP;;OARD;MAaFoL,IAbE,CAaGZ,UAbH,CAAP;KAPU,CAtBZ,EApCI,EAAd;;AClEA;;AAEA,MAAMuB,YAAY,GAAG5M,IAAE,CAAC6M,SAAH,KAAiBlR,SAAjB,GAA6BqE,IAA7B,GAAkCA,IAAE,CAAC6M,SAA1D;;AAEA,SAASC,QAAT,CAAkBtR,GAAlB,EAAuB;MACf,OAAOA,GAAP,KAAe,QAAnB,EAA6B;UACnB,IAAIiB,0BAAJ,CAA+B,KAA/B,EAAsCjB,GAAtC,CAAN;;;;AAIR,SAASuR,QAAT,CAAkBhS,GAAlB,EAAuB;MACfV,WAAW,CAAC2S,OAAZ,CAAoBjS,GAApB,MAA6B,CAAC,CAAlC,EAAqC;UAC3B,IAAI6B,4BAAJ,CAAiC,KAAjC,EAAwC7B,GAAxC,CAAN;;;;AAIR,SAASkS,aAAT,CAAuB9R,QAAvB,EAAiC;MACzBV,iBAAiB,CAACuS,OAAlB,CAA0B7R,QAA1B,MAAwC,CAAC,CAA7C,EAAgD;UACtC,IAAIyB,4BAAJ,CAAiC,UAAjC,EAA6CzB,QAA7C,CAAN;;;;AAIR,SAAS+R,SAAT,CAAmB9R,IAAnB,EAAyB;MACjBP,YAAY,CAACmS,OAAb,CAAqB5R,IAArB,MAA+B,CAAC,CAApC,EAAuC;UAC7B,IAAIwB,4BAAJ,CAAiC,MAAjC,EAAyCxB,IAAzC,CAAN;;;;AAIR,SAAS+R,yBAAT,CAAmCC,cAAnC,EAAmDlS,QAAnD,EAA6D;MACrDkS,cAAc,KAAK,MAAnB,IAA6BlS,QAAQ,KAAKS,SAA9C,EAAyD;UAC/C,IAAImB,2BAAJ,EAAN;;;;AAIR,AAAe,MAAMuQ,KAAN,SAAoBC,YAApB,CAAiC;;;;;;;;;;;EAW5CtY,WAAW,CAAC8G,MAAD,EAAS;;;UAGVN,GAAG,GAAGM,MAAM,CAACN,GAAnB;UACMN,QAAQ,GAAGY,MAAM,CAACZ,QAAxB;UACMkS,cAAc,GAAGtR,MAAM,CAACf,GAAP,KAAeY,SAAf;IACnBtB,WAAW,CAAC,CAAD,CADQ;IAEnByB,MAAM,CAACf,GAFX;UAGMI,QAAQ,GAAGW,MAAM,CAACX,QAAP,KAAoBQ,SAApB;IACblB,iBAAiB,CAAC,CAAD,CADJ;IAEbqB,MAAM,CAACX,QAFX;UAGMH,OAAO,GAAGrG,KAAK,CAACC,OAAN,CAAckH,MAAM,CAACd,OAArB,MAAkC,IAAlC;IACZc,MAAM,CAACd,OADK;MAAhB;UAGMI,IAAI,GAAGU,MAAM,CAACV,IAAP,KAAgBO,SAAhB,GAA4Bd,YAAY,CAAC,CAAD,CAAxC,GAA8CiB,MAAM,CAACV,IAAlE;;IAEA0R,QAAQ,CAACtR,GAAD,CAAR;IACAuR,QAAQ,CAACK,cAAD,CAAR;IACAD,yBAAyB,CAACC,cAAD,EAAiBlS,QAAjB,CAAzB;IACA+R,aAAa,CAAC9R,QAAD,CAAb;IACA+R,SAAS,CAAC9R,IAAD,CAAT;;SAEKU,MAAL,GAAc;MACVN,GADU;MAEVT,GAAG,EAAEqS,cAFK;MAGVpS,OAHU;MAIVC,IAAI,EAAEa,MAAM,CAACb,IAJH;MAKVC,QALU;MAMVC,QANU;MAOVC,IAPU,EAAd;;SASKmI,IAAL,GAAYA,IAAI,CAAC6J,cAAD,CAAhB;SACK9J,KAAL,GAAaA,OAAK,CAAC8J,cAAD,CAAlB;;QAEI,OAAOtR,MAAM,CAACb,IAAd,KAAuB,QAA3B,EAAqC;WAC5BsI,IAAL;WACYA,IADZ;QAEItI,IAAI,EAAE,MAAMa,MAAM,CAACb,IAFvB;;;;EAMFwI,oBAAN,GAA6B;UACrBnP,MAAM,GAAG,IAAb;;UAEI;cACM0L,IAAE,CAACuN,MAAH;QACFzN,IAAI,CAACjL,IAAL,CAAU,KAAI,CAACiH,MAAL,CAAYN,GAAtB,EAA2B,cAA3B,CADE;QAEFoR,YAAY,CAACY,IAAb,GAAoBZ,YAAY,CAACa,IAF/B;SAAN;OADJ,CAKE,OAAOtQ,GAAP,EAAY;QACV7I,MAAM,GAAG,KAAT;;;aAGGA,MAAP,CAZyB;;EAc7BkN,IAAI,CAAC9F,GAAD,EAAM;WACC8F,IAAI,CAAC,KAAK1F,MAAL,CAAYN,GAAb,EAAkBE,GAAlB,CAAX;;EAEJuN,QAAQ,CAACyE,aAAD,EAAgB;WACb1N,IAAE,CAACiJ,QAAH,CAAYnJ,IAAI,CAACjL,IAAL,CAAU,KAAKiH,MAAL,CAAYN,GAAtB,EAA2BkS,aAA3B,CAAZ,EAAuD,MAAvD,CAAP;;EAEJxE,SAAS,CAACwE,aAAD,EAAgBC,QAAhB,EAA0B;WACxB3N,IAAE,CAACkJ,SAAH;IACHpJ,IAAI,CAACjL,IAAL,CAAU,KAAKiH,MAAL,CAAYN,GAAtB,EAA2BkS,aAA3B,CADG;IAEHC,QAFG,CAAP;;;EAKJC,OAAO,GAAG;SACDC,kBAAL;GA/EwC;;AC/CzC,SAASC,MAAT,CAAgBhS,MAAhB,EAAwB;SACpB,IAAIuR,KAAJ,CAAUvR,MAAV,CAAP;;;;;ACDWsF,6FAAf,aAAuB;UACb5F,GAAG,GAAGlD,OAAO,CAACkD,GAAR,EAAZ;UACMM,MAAM,qBAAOkF,IAAP,CAAZ;UACMnC,cAAc,GAAG;MACnBpI,MAAM,EAAE6B,OAAO,CAAC8G,MADG;MAEnBD,UAAU,EAAE6B,IAAI,CAAC7B,UAFE,EAAvB;;UAIM4O,QAAQ,GAAGrO,SAAS,CAACsB,IAAI,CAAC+M,QAAN,CAA1B;;IAEAjS,MAAM,CAACN,GAAP,GAAaA,GAAb;;UAEMoD,KAAK,GAAGkP,MAAM,CAAChS,MAAD,CAApB;;IAEAiS,QAAQ,CAACnP,KAAD,EAAQC,cAAR,CAAR;QACI;YACM8K,GAAG,CAAC/K,KAAD,CAAT;KADJ,CAEE,OAAOzB,GAAP,EAAY;MACVyB,KAAK,CAACyC,IAAN,CAAW,OAAX,EAAoBlE,GAApB;;;;AAIRiE,KAAK"}